<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title></title>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
	<meta http-equiv="X-UA-Compatible" content="IE=8">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">

	<link rel="stylesheet" href="css/main.css">
	<link href="css/sp.css" rel="stylesheet" type="text/css" />
	<link href="css/reset.css" rel="stylesheet" type="text/css" />
	<link href="css/system.css" rel="stylesheet" type="text/css" />
	<link href="css/table_form.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="js/jquery-1.4.1.js"></script>
	<script type="text/javascript" src="js/cookie.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/jquery.i18n.properties-1.0.9.js"></script>
	<script type="text/javascript" src="js/add_edit_live.js"></script>
	<script type="text/javascript" src="js/bean.js"></script>
	<script type="text/javascript">
		var InformationIsNotCorrect ;
		var NoUser;
		$(function(){
			Init_license(authorization);
			var Languages = $.cookie('internationalization');

			if ( Languages == null || Languages == "" )
			{
				Languages = 'zh' ;
			}
			jQuery.i18n.properties({
				name : 'strings', //资源文件名称
				path : '/i18n/', //资源文件路径
				mode : 'map', //用Map的方式使用资源文件中的值
				language : Languages,
				encoding : 'UTF-8', // 必须写 否则中文乱码
				callback : function() {//加载成功后设置显示内容
					$('#information').html($.i18n.prop('EssentialInformation'));
					$('#td_1').html($.i18n.prop('Name'));
					$('#td_2').html($.i18n.prop('Password'));
					$('#td_3').html($.i18n.prop('NickName'));
					$('#td_4').html($.i18n.prop('Email'));
					$('#td_5').html($.i18n.prop('Telephone'));
					$('#td_6').html($.i18n.prop('Status'));
					$("#isLock").html($.i18n.prop('Lock'));
					$("#normal").html($.i18n.prop('Normal'));
					$('#dosubmit').val($.i18n.prop('Determine'));

					InformationIsNotCorrect = $.i18n.prop('InformationIsNotCorrect');
					NoUser = $.i18n.prop('NoUser');
				}
			});
		});

		(function($){
			$.getUrlParam = function(name)
			{
				var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
				var r = window.location.search.substr(1).match(reg);
				if (r!=null) return unescape(r[2]); return null;
			}
		})(jQuery);
		var beforeId = $.getUrlParam("id");
		$(function(){
			init_whole_page(beforeId);
		})

		var obj;
		function init_whole_page(befid)
		{
			$.ajax({
				type: "GET",
				async: false,
				url: locationHref+"/rest/admin/AdminUsers/"+befid+"/userInfo",//获取用户信息
				success: function(data)
				{
					obj = data;
					if(obj == null)
					{
						window.top.art.dialog({id:"show",content:NoUser+"!",time:1});
					}
					var id = obj.id;
					var type = obj.type;
					var name = obj.user;
					var nickName  = obj.alias;
					var password  = obj.password;
					var email  = obj.email;
					var telephone  = obj.phone;
					var vouTypes = obj.vodTypes;
					var mediaTypes = obj.mediaTypes;
					var authUpload = obj.authUpload;
					//var status  = obj.status;
					$("#name").val(name);
					$("#userId").val(beforeId);
					$("#password").val(password);
					$("#nickName").val(nickName);
					$("#email").val(email);
					$("#telephone").val(telephone);
					//$("#status").val(status+"");
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
			window.top.art.dialog({id:"wait"}).close();
		}


		function editUser() {
			var id = $("#userId").val();
			var name = $("#name").val();
			var password = $("#password").val();
			var nickName = $("#nickName").val();
			var telephone = $("#telephone").val();
			var email = $("#email").val();
			/*var status = $("#status").val();
			if(status == "true")
			{
				status = true;
			}
			else
			{
				status = false;
			}
*/
			var user = new User(nickName,password,email,telephone);
			//var user = new User(password,nickName,telephone,email,status);
			//alert(stringify(user))
			$.ajax({
				type: "PUT",
				async: false,
				url: locationHref+"/rest/admin/AdminUsers/"+id+"/userInfo",//编辑用户信息
				data:stringify(user),
				success: function(data)
				{
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}
	</script>
</head>

<body>

<div class="pad-10">
<div class="common-form">
<form id="myform" method="post" action="" name="myform">
	<input type="hidden" name="dialog" value="edit">
<fieldset>
	<legend id="information">基本信息</legend>
	<table width="100%" class="table_form">
		<tbody>
		<input type="hidden" id="userId" class="input-text" name="userId" value="" readonly>
		<tr>
			<td width="80" id="td_1">名称</td>
			<td>
				<input type="text" id="name" class="input-text" name="name" value="" readonly>
			</td>
		</tr>
		<tr>
			<td width="80" id="td_2">密码</td>
			<td>
				<input type="password" id="password" class="input-text" name="password" value="">
			</td>
		</tr>
		<tr>
			<td width="80" id="td_3">昵称</td>
			<td>
				<input type="text" id="nickName" class="input-text" name="nickName" value="">
			</td>
		</tr>
		<tr>
			<td width="80" id="td_4">邮箱</td>
			<td>
				<input type="text" id="email" class="input-text" name="email" value="">
			</td>
		</tr>
		<tr>
			<td width="80" id="td_5">电话</td>
			<td>
				<input type="text" id="telephone" class="input-text" name="telephone" value="">
			</td>
		</tr>
		<!--<tr>
			<td width="80" id="td_6">状态</td>
			<td>
				<select id="status">
					<option value="true" id="isLock">正常</option>
					<option value="false" id="normal">锁定</option>
				</select>
			</td>
		</tr>-->
		</tbody>
	</table>
    
</fieldset>
  
    <input type="submit" class="dialog" value="确定" id="dosubmit" name="dosubmit">
	<!--<a href="#" class=" sp_but_cir sp_but_padding btn btn-info" >取消</a>-->
	</form>
</div>
</div>

</body>
</html>
