<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=8">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">

	<link rel="stylesheet" href="css/common.css">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/main.css">
	<link href="css/sp.css" rel="stylesheet" type="text/css" />
	<link href="css/reset.css" rel="stylesheet" type="text/css" />
	<link href="css/system.css" rel="stylesheet" type="text/css" />
	<link href="css/table_form.css" rel="stylesheet" type="text/css" />
	<link href="css/dialog.css" rel="stylesheet" type="text/css" />

	<script type="text/javascript" src="js/jquery-1.4.1.js"></script>
	<script type="text/javascript" src="js/jquery.corner.js"></script>
	<script type="text/javascript" src="js/admin_common.js"></script>
	<script type="text/javascript" src="js/dialog.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/cookie.js"></script>
	<script type="text/javascript" src="js/jquery.i18n.properties-1.0.9.js"></script>
	<script type="text/javascript" src="js/bean.js"></script>
	<script type="text/javascript">
		var Authed;
		var AuthError;
		var IPPortMacNotNul;
		var IPPortMacNotEmailNul;
		var LongAuthReview;
		var LongAuthError;
		$(function(){
			//Init_license(authorization);
			var Languages = $.cookie('internationalization');

			if ( Languages == null || Languages == "" )
			{
				Languages = 'zh' ;
			}
			jQuery.i18n.properties({
				name : 'strings', //资源文件名称
				path : '/i18n/', //资源文件路径
				mode : 'map', //用Map的方式使用资源文件中的值
				language : Languages,
				encoding : 'UTF-8', // 必须写 否则中文乱码
				callback : function() {//加载成功后设置显示内容
					$('#td_1').html($.i18n.prop('ApplyNetStatus'));
					$('#td_1_1').html($.i18n.prop('OnlineApply'));
					$('#td_1_2').html($.i18n.prop('OffLineApply'));
					$('#td_2').html($.i18n.prop('LocalMacAddress'));
					$('#td_3').html($.i18n.prop('ApplySeverAddress'));
					$('#td_4').html($.i18n.prop('CustomerName'));
					$('#td_5').html($.i18n.prop('Sex'));
					$('#td_5_1').html($.i18n.prop('Male'));
					$('#td_5_2').html($.i18n.prop('Female'));
					$('#td_6').html($.i18n.prop('CustomerTel'));
					$('#td_7').html($.i18n.prop('Fax'));
					$('#td_8').html($.i18n.prop('Email'));
					$('#td_9').html($.i18n.prop('CompanyAddress1'));
					$('#td_10').html($.i18n.prop('CompanyWebAddress'));
					$('#td_11').html($.i18n.prop('RenewalNetworkStatus'));
					$('#td_11_1').html($.i18n.prop('OnlineRenewal'));
					$('#td_11_2').html($.i18n.prop('OfflineRenewal'));
					$('#td_12').html($.i18n.prop('LocalMacAddress'));
					$('#td_13').html($.i18n.prop('Fax'));
					$('#dosubmitApply').val($.i18n.prop('SubmitApply'));
					$('#dosubmitLong').val($.i18n.prop('SubmitRenewal'));
					$('#OnlineApplyInfor').html($.i18n.prop('OnlineApplyInfor'));
					$('#OfflineApplyInfor').html($.i18n.prop('OfflineApplyInfor'));
					$('#warn').html($.i18n.prop('warn'));
					$('#ApplyPage').val($.i18n.prop('ApplyPage'));
					$('#RenewalPage').val($.i18n.prop('RenewalPage'));
					$('#UploadPage').val($.i18n.prop('UploadPage'));

					Authed = $.i18n.prop('Authed');
					AuthError = $.i18n.prop('AuthError');
					IPPortMacNotNul = $.i18n.prop('IPPortMacNotNul');
					IPPortMacNotEmailNul = $.i18n.prop('IPPortMacNotEmailNul');
					LongAuthReview = $.i18n.prop('LongAuthReview');
					LongAuthError = $.i18n.prop('LongAuthError');
				}
			});
		});
		$(function(){
			init_runtime();
		})
		function init_runtime()
		{
			$.ajax({
				type: "GET",
				url: locationHref+"/rest/admin/system/getMacList",//获取mac地址
				success: function(data)
				{
					var licObj = data;
					for(var i=0;i<licObj.length;i++)
					{
						var dom = "<option value="+licObj[i].mac+">"+licObj[i].mac+"</option>";
						$("#mac").append(dom);
						$("#mac1").append(dom);
					}
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}

			})
		}

		function setLicense()
		{
			var status = $("#status").val();
			var ip = $("#ip").val();
			var port = parseInt($("#port").val());
			var mac = $("#mac").val();
			var name = $("#name").val();
			var sex = parseInt($("input[name='sex']:checked").val());
			var tel = $("#tel").val();
			var fax = $("#fax").val();
			var email = $("#email").val();
			var company = $("#company").val();
			var webAddr = $("#webAddr").val();
			var info = new License(ip,port,mac,name,sex,tel,fax,email,company,webAddr,status);

			if(status == "true")
			{
				if(ip != "" && mac != "" && port != null && name != "" && email != "")
				{
					$.ajax({
						type: "POST",
						url: locationHref+"/rest/admin/system/amsApply",//授权申请
						async: false,
						data: JSON.stringify(info),
						success: function(data)
						{
							window.top.art.dialog({id:"mesg",content:Authed+"!",time:3});
						},
						error: function()
						{
							window.top.art.dialog({id:"err",content:AuthError+"!",time:2});
						}
					})

				}
				else
				{
					window.top.art.dialog({id:"err",content:""+"!",time:2});
				}
			}
			else if(status == "false")
			{
				if( mac != "" && name != "" && email != "")
				{
					$.ajax({
						type: "POST",
						url: locationHref+"/rest/admin/system/amsApply",//授权申请
						async: false,
						data: JSON.stringify(info),
						success: function(data)
						{
							window.top.art.dialog({id:"mesg",content:Authed+"!",time:3});
						},
						error: function()
						{
							window.top.art.dialog({id:"err",content:AuthError+"!",time:2});
						}
					})

				}
				else
				{
					window.top.art.dialog({id:"err",content:IPPortMacNotNul+"!",time:2});
				}
			}

		}

		function setLongLicense()
		{
			var ip1 = $("#ip1").val();
			var port1 = parseInt($("#port1").val());
			var mac1 = $("#mac1").val();
			var status1 = $("#status1").val();
			var longInfo = new LongLicense(ip1,port1,mac1,status1);
			//alert(JSON.stringify(longInfo));
			if(ip1 != "" && mac1 != "" && port1 != null)
			{
				$.ajax({
					type: "POST",
					url: locationHref+"/rest/admin/system/amsReNewAl",//授权续期
					async: false,
					data: JSON.stringify(longInfo),
					success: function(data)
					{
						window.top.art.dialog({id:"mesg",content:LongAuthReview+"!",time:2});
					},
					error: function()
					{
						window.top.art.dialog({id:"err",content:LongAuthError+"!",time:2});
					}
				})
			}
			else
			{
				window.top.art.dialog({id:"err",content:IPPortMacNotNul+"!",time:2});
			}
		}

		function applyLic()
		{
			$("#myform").show();
			$("#myform1").hide();
		}
		function applyLongLic()
		{
			$("#myform1").show();
			$("#myform").hide();
		}

		function uploadPage()
		{
			window.top.art.dialog
			(
					{
						id:'upload',iframe:'/upload_lic.html', title:'上传lic文件', width:'400', height:'200', lock:true,window:'top'
					}
			);void(0);
		}

		function statusChange(flag)
		{
			if(flag == "true")
			{
				$("#applyStatus").show();
			}
			else
			{
				$("#applyStatus").hide();
			}
		}

		function statusChange1(flag)
		{
			if(flag == "true")
			{
				$("#longLic").show();
			}
			else
			{
				$("#longLic").hide();
			}
		}

	</script>
	<title></title>
</head>
<body scroll="yes" style="overflow-y: scroll;">
<div>
	<input type="button" id="ApplyPage" value="申请页" class="ext_btn ext_btn_success" onclick="applyLic()">
	<input type="button" id="RenewalPage" value="续期页" class="ext_btn ext_btn_success" onclick="applyLongLic()">
	<input type="button" id="UploadPage" value="上传页" class="ext_btn ext_btn_success" onclick="uploadPage()">
</div>
<div style="display: inline;width:100%;">
	<div style="width: 60%;border: 1px;float: left;">
		<form id="myform" action="#" method="post" >
			<table width="100%" class="table_form">
				<input type="hidden" name="port" id="port" size="56" value="5555">
				<tr >
					<td id="td_1">
						申请网络状态：
					</td>
					<td>
						<select id="status" name="status" onchange="statusChange(this.value)">
							<option id="td_1_1" value="true">在线申请</option>
							<option id="td_1_2" value="false">离线申请</option>
						</select>
					</td>
				</tr>
				<tr>
					<td id="td_2">
						本机mac：
					</td>
					<td>
						<select id="mac" name="mac">

						</select>
					</td>
				</tr>
				<tr id="applyStatus">
					<td id="td_3">
						授权申请服务器地址：
					</td>
					<td>
						<input type="text" name="ip" id="ip" size="56" value=""><span style="color: red;display: inline">*</span>
					</td>
				</tr>
				<tr >
					<td id="td_4">
						客户姓名：
					</td>
					<td>
						<input type="text" name="name"   id="name" size="56" value=""><span style="color: red;display: inline">*</span>
					</td>
				</tr>
				<tr >
					<td id="td_5">
						性别:
					</td>
					<td>
						<input type="radio" checked="checked" name="sex" size="56" value="1" /><label id="td_5_1">男</label>
						<input type="radio" name="sex" value="2" /><label id="td_5_2">女</label>
					</td>
				</tr>
				<tr >
					<td id="td_6">
						客户电话:
					</td>
					<td>
						<input type="text" name="tel" id="tel" size="56" value=""><span style="color: red;display: inline">*</span>
					</td>
				</tr>
				<tr >
					<td id="td_7">
						传真：
					</td>
					<td>
						<input type="text" name="fax" size="56" id="fax" value=""><span style="color: red;display: inline">*</span>
					</td>
				</tr>
				<tr >
					<td id="td_8">
						邮箱：
					</td>
					<td>
						<input type="text" name="email"  id="email" size="56" value=""><span id="warn" style="color: red;display: inline">*请注意核实</span>
					</td>
				</tr>
				<tr >
					<td id="td_9">
						公司地址：
					</td>
					<td>
						<input type="text" name=company  id="company" size="56" value=""><span style="color: red;display: inline">*</span>
					</td>
				</tr>
				<tr >
					<td id="td_10">
						公司网址：
					</td>
					<td>
						<input type="text" name="webAddr"  id="webAddr" size="56" value=""><span style="color: red;display: inline">*</span>
					</td>
				</tr>
				<tr>
					<td align="left" >
						<input  type="button" value=" 申请 " id="dosubmitApply" onclick="setLicense()" class="ext_btn ext_btn_submit" />
					</td>
					<td align="left" >

					</td>
				</tr>
			</table>
		</form>
		<form id="myform1" action="#" method="post" style="display: none;">
			<table width="100%" class="table_form">
				<input type="hidden" name="port1" id="port1" size="56" value="5555">
				<tr >
					<td id="td_11">
						续期网络状态：
					</td>
					<td>
						<select id="status1" name="status1" onchange="statusChange1(this.value)">
							<option id="td_11_1" value="true">在线续期</option>
							<option id="td_11_2" value="false">离线续期</option>
						</select>
					</td>
				</tr>
				<tr >
					<td id="td_12">
						本机mac：
					</td>
					<td>
						<select id="mac1" name="mac1">

						</select>
					</td>
				</tr>
				<tr id="longLic">
					<td id="td_13">
						续期服务器地址：
					</td>
					<td>
						<input type="text" name="ip1" id="ip1" size="56" value=""><span style="color: red;display: inline">*</span>
					</td>
				</tr>
				<tr>
					<td align="left" >
						<input  type="button" value=" 续期 " id="dosubmitLong" onclick="setLongLicense()" class="ext_btn ext_btn_submit" />
					</td>
					<td align="left" >
					</td>
				</tr>
			</table>
		</form>
	</div>
	<div style="width: 30%;float: left;">
		<div>
			<img src="images/bjsin_own.png" style="float: none;" width="100%" height="240px"/>
		</div>
		<div>
			<span style="color: #2ba949;font-size: medium;" id="OnlineApplyInfor">
				在线申请:关注公众号,获取授权服务器ip地址,填写信息申请授权,授权将以邮箱形式发送
			</span>
			<span style="color: #D50000;font-size: medium;" id="OfflineApplyInfor">
				离线申请:关注公众号,将填写的信息清楚拍下并发送至公众号,等待授权,授权将以邮箱形式发送
			</span>
		</div>
	</div>
</div>

</body>
</html>


