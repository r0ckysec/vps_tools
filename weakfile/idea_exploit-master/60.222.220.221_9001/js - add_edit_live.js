
function check()
{
	var com_str = /\w+/;	
	var rtmp = /rtmp:\/\/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+[a-zA-Z:\/]+/;
	var ts_reg = /[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+[:][0-9]+/;
	var num = /^\+?[1-9][0-9]*$/;　　//正整数 
	
	var appName = $("#appName").val();
	var liveName = $("#liveName").val();
	var alias = $("#alias").val();
	var isPush = $("#isPush").val();

	var url = $("#url").val()
	var width = $("#width").val()
	var height = $("#height").val()
	var frameRate = $("#frameRate").val()
	var samplingRate = $("#sampleRate").val()
	var vbitRate = $("#vBitRate").val()
	var abitRate = $("#aBitRate").val()
	var ts = $("#ts").val();
	var playbackDays = $("#keepPlaybackDays").val();
	var dataPath = $("#dataPath").val();
	
	if(!com_str.test(appName))
	{
		window.top.art.dialog({id:'dg_test34243', content:'应用名称格式错误,不允许有空格,内容为英文与数字组合!',time:1});		
		return false;
	}
	else if(!com_str.test(liveName))
	{
		window.top.art.dialog({id:'dg_test34243', content:'流名称格式错误,不允许有空格,内容为英文与数字组合!',time:1});		
		return false;
	}
	else if(alias == "")
	{
		window.top.art.dialog({id:'dg_test34243', content:'别名不能为空!',time:1});		
		return false;
	}
	
	if(ts == "1")
	{
		var tsAddress = $("#tsAddress").val();
		if(!ts_reg.test(tsAddress))
		{
			 window.top.art.dialog({id:'dg_test34243', content:'ts地址不正确!',time:1});		
			return false;
		}
	}
	
	if(!num.test(playbackDays))
	{
		window.top.art.dialog({id:'dg_test34243', content:'回播天数不正确!',time:1});		
		return false;
	}

	if(isPush == "false")
	{
		if(url == "")
		{
			window.top.art.dialog({id:'dg_test34243', content:'拉流URL不正确!',time:1});		
			return false;
		}
		if(!num.test(width) || !num.test(height))
		{
			window.top.art.dialog({id:'dg_test34243', content:'分辨率不正确!',time:1});		
			return false;
		}
		if(!num.test(width) || !num.test(height))
		{
			window.top.art.dialog({id:'dg_test34243', content:'分辨率不正确!',time:1});		
			return false;
		}
		if(!num.test(frameRate))
		{
			window.top.art.dialog({id:'dg_test34243', content:'帧率不正确!',time:1});		
			return false;
		}
		if(!num.test(samplingRate))
		{
			window.top.art.dialog({id:'dg_test34243', content:'采样率不正确!',time:1});		
			return false;
		}
		if(!num.test(vbitRate))
		{
			window.top.art.dialog({id:'dg_test34243', content:'视频比特率不正确!',time:1});		
			return false;
		}
		if(!num.test(abitRate))
		{
			window.top.art.dialog({id:'dg_test34243', content:'音频比特率不正确!',time:1});		
			return false;
		}
	}
	
	var autoCategory = $("#autoCategory").val(); 
	var recordName = $("#recordName").val();
	
	
	if(dataPath == "")
	{
		window.top.art.dialog({id:'dg_test34243', content:'录像存放路径不能为空!',time:1});		
		return false;
	}
	return true;
}

function stringify(object){
	var string = JSON.stringify(object)
	return string.replace(/\\u([0-9a-fA-F]{2,4})/g,function(string,matched){
		return String.fromCharCode(parseInt(matched,16))
	})
}

function ts_hls_oper()
{
	$.ajax({
		type: "GET",
		url: locationHref+"/rest/admin/system/getLicenseInfo",//获取授权
		success:function(data)
		{
			var obj = null;
			try
			{
				obj = data;
			}
			catch(e)
			{
				return ;
			}

			var ts_enable = obj.supportTS;
			var hls_enable = obj.supportHLS;
			if(ts_enable == true)
			{
				$("#ts_oper").show();
			}

			if(hls_enable == true)
			{
				$("#hls_oper").show();
			}

		}

	})

}


/**
 * 直播定时选择开启或关闭的处理事件
 * @param val
 * @return
 */
function live_time_sel(val)
{
	if(val == "true")
	{
		$("#liveProperty option").each(function(){
			
			if($(this).attr("value") != "3" )
			{
				$(this).attr("disabled",true);
			}
			else
			{
				$(this).attr("selected",true);
			}
		})
	}
	else if(val == "false")
	{
		$("#liveProperty option").each(function(){
			$(this).attr("disabled",false);	
			$(this).attr("selected",false);
		})
	}
}


function do_create_live_cate(div_id,localams)
{
	$.ajax({
		  type: "POST",
		  url: "/admin/live/group/liveGroupJSONList.action",
		 // data:{action:'list'},		 
		  //处理CGI返回的JSON数据
		  success: function(data)
		  {	
			var select_begin = "<select id='right' name='right' class='select' ></select>"
			$("#"+div_id).append(select_begin);
			
			//解析JSON			
			var obj = $.parseJSON(data);				
			if(obj != null && obj.length>0)
			{
				//add the root category
				for(var i=0;i<obj.length;i++)
				{
					var id = obj[i].id;					
					var name = obj[i].name.replace(/[ ]/g,"&nbsp;");
					var moduleType = obj[i].moduleType;//  1. 普通直播   2. 访谈类型    3.回播模式   4.轮播 5.导播	
					
					var option = "<option value='"+id+"'>"+name+"</option>"
					if(moduleType == 2 || moduleType == 4 || moduleType == 5)
					{
						if(localams == "127.0.0.1")
							$("#right").append(option);
					}
					else
					{
						$("#right").append(option);
					}
				}
			}
			else
			{
				$("#right").append("<option value='0'>请先创建直播组</option>");
			}
		  }
	});	
}



/*function pull_select(v)
{
	if(v == "false")
	{
		$("#pull_body").css("display","")
	}
	else
	{
		$("#pull_body").hide();
	}
}

function select_take(v)
{
	if(v == "true")
	{
		$("#take_body").css("display","")
	}
	else
	{
		$("#take_body").hide();
	}
}*/



/*流方式  1.推流  2.拉流*/
function pull_select(v)
{
	var lazyPull = $("#lazyPull").val();
	var lazyPush = $("#lazyPush").val();
	if(v == "false")
	{
		/*拉流显示内容*/
		$("#pullBody").show();
		$("#engineIdBody").show();
		$("#pushBody").hide();
		$("#playDeleayTime").hide();
		$("#pull_body").css("display","")
		if(lazyPull == "true")
		{
			$("#take_body").show();
			$("#pull_body").show();
		}
		else
		{
			$("#take_body").hide();
			$("#pull_body").show();
		}
		if($("input[type='radio']:checked").val() == "true")
		{
			$("#transferPlan").show();
		}
		else
		{
			$("#transferPlan").hide();
			$("#tf_select").val("-1");
		}

		$.ajax({
			type: "GET",
			async: false,
			url: locationHref+"/rest/admin/transfer/GetTransferEngine",//获取插件列表
			success: function(data)
			{
				//解析JSON
				var obj = data;
				if(obj != null )
				{
					$("#engineIdBody").show();
					for(var i=0;i<obj.length;i++)
					{
						var id = obj[i].id;
						var option = "<option value='"+id+"'>"+id+"</option>"
						$("#engineId").append(option);
					}
				}
				else
				{
					$("#engineIdBody").hide();
				}
			},
			error:function(data)
			{
				var errorObj = data;
				var status = data.status;
				var statusText = data.statusText
				if(status == 401 || status == 400)
				{
					top.location.href = "login.html";
				}
				else if(status == 409)
				{
					window.top.art.dialog({id:"mesg",content:statusText+"!",time:2});
				}
			}
		});
	}
	else
	{
		/*推流显示内容*/
		//$("#take_body").show();   //自动关闭
		//$("#playDeleayTime").show();  //缓冲时间
		$("#pull_body").hide();
		$("#engineIdBody").hide();
		$("#pullBody").hide();
		$("#pushBody").show();
		if(lazyPush == "true")
		{
			$("#playDeleayTime").show();
			$("#take_body").show();
		}
		else
		{
			$("#take_body").hide();
			$("#playDeleayTime").hide();
		}
		$("#transferPlan").hide();
		$("#tf_select").val("-1");
	}
	$("#isPush").val(v);
}

/*推流接入方式   1.客户端   2.立即启动*/
function select_take(v)
{
	var isPush = $("#isPush").val();
	if(v == "false")
	{
		$("#take_body").hide();
		$("#playDeleayTime").hide();
	}
	else
	{
		$("#take_body").show();
		$("#playDeleayTime").show();
	}

}

/*拉流接入方式   1.客户端   2.立即启动*/
function select_take_pull(v)
{
	var isPush = $("#isPush").val();
	if(v == "false")
	{
		$("#take_body").hide();
		$("#pull_body").show();
	}
	else
	{
		$("#take_body").show();
		$("#pull_body").show();
	}

}


function auto_category(v)
{
	if(v == "false")
	{
		$("#auto_category_body").hide();
	}
	else
	{
		$("#auto_category_body").css("display","")
	}
}
function record_type(val)
{
	if(val == "time")//时间
	{
		$("#intervalTime").val();
		$("#splitFileSize").val("0");
		$("#time_type").show();
		$("#much_type").hide();
	}
	else//大小
	{
		$("#splitFileSize").val();
		$("#intervalTime").val("0");
		$("#much_type").show();
		$("#time_type").hide();
	}
}

function choose_vtransfer(val)
{
	if(val == "false")
		$("#vinfo").hide();
	else
		$("#vinfo").show();
}
function choose_atransfer(val)
{
	if(val == "false")
		$("#ainfo").hide();
	else
		$("#ainfo").show();
}


function catOpenStatus(val)
{
	if(val == "false")
		$("#level").show();
	else
		$("#level").hide();
}

function selectPath()
{
	window.top.art.dialog
	(
		{
			id:'path',iframe:"select_data_path.html", title: '选择目录', width:'600', height:'450', lock:true,window:'top'
		},
		function(){
			var d = window.top.art.dialog({id:'path'}).data.iframe;
			var aaa = d.setSubDirInfo();
			$("#dataPath").val(aaa);
			window.top.art.dialog({id:'path'}).close();
			return false;
		},
		function()
		{
			window.top.art.dialog({id:'path'}).close();
		}
	);void(0);
}
