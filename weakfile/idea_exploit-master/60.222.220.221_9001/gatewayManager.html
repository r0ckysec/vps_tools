<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=8">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<link rel="stylesheet" href="css/common.css">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/main.css">
	<link href="css/sp.css" rel="stylesheet" type="text/css" />
	<link href="css/reset.css" rel="stylesheet" type="text/css" />
	<link href="css/system.css" rel="stylesheet" type="text/css" />
	<link href="css/table_form.css" rel="stylesheet" type="text/css" />
	<link href="css/dialog.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="js/dialog/jquery.ui.all.css"/>
	<script type="text/javascript" src="js/jquery-1.4.1.js"></script>
	<script type="text/javascript" src="js/jquery.corner.js"></script>
	<script type="text/javascript" src="js/admin_common.js"></script>
	<script type="text/javascript" src="js/dialog.js"></script>
	<script type="text/javascript" src="js/cookie.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/jquery.i18n.properties-1.0.9.js"></script>
	<script type="text/javascript" src="js/time.js"></script>
	<script type="text/javascript" src="js/ref_encode.js"></script>
	<script type="text/javascript" src="js/jquery.form.js"></script>
	<script type="text/javascript" src="js/encoder.js" ></script>
	<script type="text/javascript" src="js/add_edit_live.js"></script>
	<script type="text/javascript" src="js/bean.js"></script>
	<script type="text/javascript">
		var init_GroupId = "";
		var refresh_flag = true;
		var AMS_Prompt ;
		var FailedToGetData ;
		var Grouping;
		var SubTitle;
		var Notgrouped;
		var Register;
		var Modify_IP_Address;
		var OpenEncoder;
		var NotRegister;
		var PleaseFirstSelect;
		var PleaseAddNetwork;
		var DeleteMethod ;
		var AddCatalog;
		var EditCatalog;
		var DelCatalog;
		var Removethisuser;
		$(function(){
			Init_license(authorization);
			var Languages = $.cookie('internationalization');
			if ( Languages == null || Languages == "" )
			{
				Languages = 'zh' ;
			}
			jQuery.i18n.properties({
				name : 'strings', //资源文件名称
				path : '/i18n/', //资源文件路径
				mode : 'map', //用Map的方式使用资源文件中的值
				language : Languages,
				encoding : 'UTF-8', // 必须写 否则中文乱码
				callback : function() {//加载成功后设置显示内容
					$('#alias').html($.i18n.prop('Alias'));
					$('#enable').html($.i18n.prop('AuthEnable'));
					$('#bOnline').html($.i18n.prop('BOnline'));
					$('#groupId').html($.i18n.prop('GroupId'));
					$('#groupName').html($.i18n.prop('GroupName'));
					$('#operation').html($.i18n.prop('Operation'));
					$('#save').html($.i18n.prop('Save'));
					$('#all_operation').html($.i18n.prop('Alloperation'));
					$('#tab_setting_1').html($.i18n.prop('gatewayList'));
					$('#tab_setting_2').html($.i18n.prop('gatewaySet'));
					$('#deviceApk').html($.i18n.prop('gatewayDevice'));
					$('#th_1').html($.i18n.prop('SerialNumber'));
					$('#th_4').html($.i18n.prop('SubnetMask'));
					$('#th_5').html($.i18n.prop('Gateway'));
					$('#th_6').html($.i18n.prop('FirmwareVersion'));
					$('#th_7').html($.i18n.prop('Operation'));
					$('#th_8').html($.i18n.prop('Registered'));
					$('#auto_refresh').html($.i18n.prop('AutoRefresh'));
					$('#auto_refresh_1').html($.i18n.prop('ReScan'));
					$('#close_refresh').html($.i18n.prop('CloseRefresh'));
					$('#allDevice').html($.i18n.prop('AllDevice'));
					$("#dosubmit").val($.i18n.prop('Determine'));
					$('#addGroup').val($.i18n.prop('AddCatalog'));
					$('#editGroup').val($.i18n.prop('EditCatalog'));
					$('#delGroup').val($.i18n.prop('DelCatalog'));
					$('#groupManager').html($.i18n.prop('GroupManagement'));
					$('#groupDev').html($.i18n.prop('BatchGrouping'));
					Register = $.i18n.prop('Register') ;
					OpenEncoder = $.i18n.prop('OpenEncoder') ;
					Modify_IP_Address = $.i18n.prop('Modify_IP_Address') ;
					NotRegister = $.i18n.prop('NotRegister') ;
					Notgrouped = $.i18n.prop('Notgrouped') ;
					Grouping = $.i18n.prop('Grouping') ;
					PleaseFirstSelect = $.i18n.prop('PleaseFirstSelect') ;
					PleaseAddNetwork = $.i18n.prop('PleaseAddNetwork') ;
					DeleteMethod = $.i18n.prop('DeleteMethod') ;
					AddCatalog = $.i18n.prop('AddCatalog') ;
					EditCatalog = $.i18n.prop('EditCatalog') ;
					DelCatalog = $.i18n.prop('DelCatalog') ;
					Removethisuser = $.i18n.prop('Removethisuser') ;
				}
			});
			init_data();
			init_whole_page();
		});
		(function($){
			$.getUrlParam = function(name)
			{
				var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
				var r = window.location.search.substr(1).match(reg);
				if (r!=null) return unescape(r[2]); return null;
			}
		})(jQuery);
		var liveType = $.getUrlParam("liveType");//区别权限是否显示

		//初始加载搜索所有网关
		function init_data()
		{
			$("#add_dom").empty();
			//init the whole dom
			$.ajax({
				type: "GET",
				async: false,
				url: locationHref+"/rest/admin/devices/3/searchDev",//搜索网关设备  3,网关
				success: function(data)
				{
					var obj = data;
					if(obj != '')
					{
						//在页面中输出dom
						for(var i=0;i<obj.length;i++)
						{
							//获取JSON对象的每个属性的值
							var ip_addr = obj[i].ip_addr;
							var mac_addr = obj[i].mac_addr;
							var ip_mask = obj[i].ip_mask;
							var	ip_gateway= obj[i].ip_gateway;
							var version = obj[i].version;
							var registerAddr = obj[i].registerAddr;
							var register_str = "";
							if(registerAddr == undefined || registerAddr == "")
							{
								register_str = NotRegister;
							}
							else
							{
								register_str = registerAddr;
							}
							var domContent = "<tr height='16'>";
							domContent+= "<td  align='center'>"+(i+1)+"</td>";
							domContent+= "<td  align='center' height='16'>"+ip_addr+"</td>";
							domContent+= "<td  align='center' height='16'>"+mac_addr+"</td>";
							domContent+= "<td  align='center' height='16'>"+ip_mask+"</td>";
							domContent+= "<td  align='center' height='16'>"+ip_gateway+"</td>";
							domContent+= "<td  align='center' height='16'>"+version+"</td>";
							domContent+= "<td  align='center' height='16'>"+register_str+"</td>";
							domContent+= "<td  align='center'>"
							domContent+= "<a href='javascript:;' onClick='registerEncoder("+ip_addr+")' class='ext_btn ext_btn_submit ext_btn_size'>"+Register+"</a>&nbsp;&nbsp;<a href='javascript:;' onClick='modifyip("+mac_addr+")' class='ext_btn ext_btn_submit ext_btn_size'>"+Modify_IP_Address+"</a>&nbsp;&nbsp;<a href=http://"+ip_addr+"  target='_blank' class='ext_btn ext_btn_submit ext_btn_size'>"+OpenEncoder+"</a>";
							domContent+= "</td>";
							domContent+= "</tr>";

							$("#add_dom").append(domContent);
						}
					}
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})

			if(refresh_flag)
			{
				$("#auto_refresh").show();
				$("#close_refresh").hide();
			}
			else
			{
				$("#auto_refresh").hide();
				$("#close_refresh").show();
			}
		}
		//加载组信息
		function init_whole_page()
		{
			$("#group_body").empty();
			$.ajax({
				type: "GET",
				url: locationHref+"/rest/admin/termGroup", // 获取所有组
				success: function(data)
				{
					var obj = data;
					if(obj != '')
					{
						var checkBox_Name = 'deviceids';
						var dom = '<input id="checkAll" name="checkAll" type="checkbox" value="-1" onclick="selectallGroup_gateway(\''+checkBox_Name+'\');"><label for="checkAll" style="background-color: #7caccf ;" > 全部 </label>';
						//var dom = '<label style="background-color: #7caccf ;" onclick="getGateway(-1)"> 全部 </label>';
						for(var i=0;i<obj.length;i++)
						{
							var groupId = obj[i].groupId;
							var groupName = obj[i].groupName;
							var groupDevType = obj[i].devType;
							if(groupDevType == 3)
							{
								dom += '  <input id="checkDevice_'+i+'" name="deviceids" type="checkbox" onclick="select_check_box_gateway(\''+groupId+'\')" value="'+groupId+'"><label for="checkDevice_'+i+'" style="background-color: #7caccf ;" > '+groupName+' </label>';
							}
						}
						$("#group_body").append(dom);
						getGateway(init_GroupId);
					}
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}
		//获取终网关列表
		function getGateway(initGroupId)
		{

			var getGroupArray = new Array();
			var getGroupCount = 0;
			$('input[type=checkbox]:checked').each(function(i){
				var group_value = $(this).val()+"";
				getGroupArray[getGroupCount] = group_value;
				getGroupCount++;
			})

			var sendUrl;
			if(getGroupArray == "" || getGroupArray.indexOf("-1") != -1 || initGroupId == "-1")
			{
				initGroupId = "";
				sendUrl = locationHref+"/rest/admin/termGroup/3/"+initGroupId+"/getGroup"
			}
			else
			{
				initGroupId = stringify(getGroupArray);
				sendUrl = locationHref+"/rest/admin/termGroup/3/"+initGroupId+"/getGroups";
			}

			$("#main_body").empty();
			$.ajax({
				type: "GET",
				//url: locationHref+"/rest/admin/devices/3/get",//获取设备列表  3,网关
				//url: locationHref+"/rest/admin/termGroup/3/"+initGroupId+"/getGroup",//获取设备列表  3,网关
				url: sendUrl,
				success: function (data)
				{
					var agreementObj = data;
					if(agreementObj != null)
					{
						if(getGroupArray == "" || getGroupArray.indexOf("-1") != -1 || initGroupId == "-1")
						{
							var groupId = agreementObj.groupId;
							var groupName = agreementObj.groupName;
							var item = agreementObj.item;
							getItems_gateway(item,initGroupId,getGroupArray,groupName);
						}
						else
						{
							for(var kk=0;kk<agreementObj.length;kk++)
							{
								var groupId = agreementObj[kk].groupId;
								var groupName = agreementObj[kk].groupName;
								var item = agreementObj[kk].item;
								getItems_gateway(item,initGroupId,getGroupArray,groupName);
							}
						}

					}
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}

		function getItems_gateway(item,initGroupId,getGroupArray,groupName)
		{
			if(item != null)
			{
				for(var i=0;i<item.length;i++)
				{
					var mac = item[i].mac;
					var devip = item[i].ip;
					var enable = item[i].enable;
					var bOnline = item[i].bOnline;
					var enableStr = "";
					var bOnlineStr = "";
					if(enable)
					{
						enableStr = '<font id="font'+i+'" style="font-size:14px;font-weight: bold; color: green">√</font>';
					}
					else
					{
						enableStr = '<font id="font'+i+'" style="font-size:14px;font-weight: bold; color: red">×</font>';
					}

					if(bOnline)
					{
						bOnlineStr = '<font id="font1'+i+'" style="font-size:14px;font-weight: bold; color: green">√</font>';
					}
					else
					{
						bOnlineStr = '<font id="font1'+i+'" style="font-size:14px;font-weight: bold; color: red">×</font>';
					}
					var alias = item[i].alias;
					if(alias == undefined)
					{
						alias = "";
					}
					var del = '<a href="javascript:;" onclick="delConnection(\''+mac+'\',\''+initGroupId+'\')" title="'+Removethisuser+'" class="ext_btn_red ext_btn_size">'+Removethisuser+'</a>&nbsp';

					var get_groupId = item[i].groupId;
					var get_groupName;
					var sendGroupName = item[i].groupName;
					if(get_groupId == "")
					{
						get_groupId = Notgrouped;
						get_groupName = Notgrouped;
					}
					else
					{
						if(initGroupId == "")
						{
							get_groupName = sendGroupName;
						}
						else
						{
							get_groupName = groupName;
						}
					}
					var dom = '<tr>';
					dom += '<td align="center">';
					dom += '<input type="checkbox" class="inputcheckbox"  name="mediainfoIds" device_ip="' + devip + '" bOnline="'+bOnline+'" alias_name="'+alias+'" value="' + mac + '">';
					dom += '</td>';
					dom += '<td align="center"><input type="text" class="input-text" id="alias" name="alias" value="'+alias+'"></td>';
					dom += '<td align="center">' + mac + '</td>';
					dom += '<td align="center">' + devip + '</td>';
					dom += '<td align="center">' + enableStr + '</td>';
					dom += '<td align="center">' + bOnlineStr + '</td>';
					dom += '<td align="center">' + get_groupName + '</td>';
					if(initGroupId == "0" && initGroupId != "")
					{
						dom += '<td align="center">不可操作</td>';
					}
					else
					{
						dom += '<td align="center">' + del + '</td>';
					}

					dom += '</tr>';
					$("#main_body").append(dom);
				}
			}
		}
		//---------------------------------------获取操作------------------------------------------
		//移除用户
		function delConnection(beforeMac,groupId)
		{
			$.ajax({
				type: "DELETE",
				url: locationHref + "/rest/admin/termGroup/" + groupId +"/"+beforeMac+ "/delDev",//删除组设备
				success: function (data)
				{
					window.location.reload();
				}
			})
		}
		//批量分组
		function groupDevList()
		{
			var ids = document.getElementsByName("mediainfoIds");
			var array = new Array();
			var str = "";
			//拼接以ID和@组合而成的字符串
			var count = 0;
			for(var i=0;i<ids.length;i++) {
				//如果多选框没有选中 , 让其选中
				if (ids[i].checked == true && i != 0) {
					ids[i].checked = true;
					var aa = $(ids[i]).parent().parent().find("#alias").val();
					if (ids[i].value != "") {
						if (count == 0) {
							str += '{"mac":"' + $(ids[i]).val() + '","alias":"' + aa + '"}';
						}
						else {
							str += ',{"mac":"' + $(ids[i]).val() + '","alias":"' + aa + '"}';
						}
						count++;
					}
				}
			}
			str = "["+str+"]";
			window.top.art.dialog
			(
					{
						id:'deviceGroup',iframe:'addDeviceToGroup.html?apkList='+encodeURI(encodeURI(str))+'&type=3', title:'批量分组', width:'500', height:'200', lock:true,window:'top'
					},
					function(){
						var d = window.top.art.dialog({id:'deviceGroup'}).data.iframe;
						d.addDeviceToGroup();
						window.top.art.dialog({id:'deviceGroup'}).close()
						window.location.href='/gatewayManager.html';
						return false;
					},
					function()
					{
						window.top.art.dialog({id:'deviceGroup'}).close()
					}
			);void(0);
		}
		//组操作
		function addApkGroup(type)
		{
			if(type == 1)
			{
				var liveUrl = 'add_group_manager.html?deviceType=3';
				if(liveType == "only")
				{
					liveUrl = 'add_group_manager.html?liveType='+liveType+'&deviceType=3';
				}
				window.top.art.dialog
				(
						{
							id:'add',iframe:liveUrl, title:AddCatalog, width:'600', height:'400', lock:true,window:'top'
						},
						function(){
							var d = window.top.art.dialog({id:'add'}).data.iframe;
							d.addGroup();
							window.top.art.dialog({id:'add'}).close();
							init_whole_page();
							return false;
						},
						function()
						{
							window.top.art.dialog({id:'add'}).close();
						}
				);void(0);
			}
			else
			{
				var length = $('input[type=checkbox]:checked').length;
				if(length < 1)
				{
					window.top.art.dialog({id:"mesg",content:"请选中一个选项!!!",time:2});
				}
				else if(length > 1)
				{
					window.top.art.dialog({id:"mesg",content:"只能操作一个选项!!!",time:2});
				}
				else
				{
					var device_group_val = $('input[type=checkbox]:checked').val();//id
					var device_group_text = $('input[type=checkbox]:checked').next().text();//name
					if(device_group_val != "0")
					{
						if(type == 2)//editDialog(id,name,type)
						{
							window.top.art.dialog
							(
									{
										id:'edit',iframe:'edit_group_manager.html?id='+device_group_val+"&name="+device_group_text+"&devType=3", title:EditCatalog, width:'600', height:'400', lock:true,window:'top'
									},
									function(){
										var d = window.top.art.dialog({id:'edit'}).data.iframe;
										d.editGroup();
										window.top.art.dialog({id:'edit'}).close();
										init_whole_page();
										return false;

									},
									function()
									{
										window.top.art.dialog({id:'edit'}).close();
									}
							);void(0);
						}
						else if(type == 3)
						{
							window.top.art.dialog
							(
									{
										id:'del',content:DeleteMethod, title:DelCatalog,lock:true
									},
									function(){
										delGroup(device_group_val);
										window.top.art.dialog({id:'del'}).close();
										init_whole_page();
										return true;
									},
									function()
									{
										window.top.art.dialog({id:'del'}).close();
									}
							)
						}
					}
				}
			}
		}
		//删除网关组
		function delGroup(id)
		{
			$.ajax({
				type:"DELETE",
				url:locationHref+"/rest/admin/termGroup/"+id+"/delete", //删除组
				async: false,
				contentType: "application/json; charset=utf-8",
				success:function(data){

				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}
		//-----------------------------------------分组操作-----------------------------------------


		//全选
		function selectall1(name) {
			if ($("#check_box").attr("checked")==false) {
				$("input[name='"+name+"']").each(function() {
					this.checked=false;
				});
			} else {
				$("input[name='"+name+"']").each(function() {
					this.checked=true;
				});
			}
		}

		function selectallGroup_gateway(name) {
			if ($("#checkAll").attr("checked")==false) {
				$("input[name='"+name+"']").each(function() {
					this.checked=false;
				});
			} else {
				$("input[name='"+name+"']").each(function() {
					this.checked=true;
				});
			}
			getGateway(-1);
		}

		function select_check_box_gateway(id)
		{
			var allcheckBoxs=document.getElementsByName("checkAll");
			var select=document.getElementsByName('deviceids');

			var flag = true;
			for(var i=0;i<select.length;i++)
			{
				if(!select[i].checked)
				{
					flag = false;
				}
			}
			if(flag)
			{
				//每一个都选择，全选按钮被选择
				for(var z=0;z<allcheckBoxs.length;z++)
				{
					allcheckBoxs[z].checked = true;
				}
			}
			else
			{
				//有一个不选择，全选按钮则不选择
				for(var y=0;y<allcheckBoxs.length;y++)
				{
					allcheckBoxs[y].checked = false;
				}
			}
			if(id == undefined)
			{
				id = -1;
			}
			getGateway(id);
		}
		//设备授权
		function enableDevList()
		{
			var ids = document.getElementsByName("mediainfoIds");
			var str = "";
			//拼接以ID和@组合而成的字符串
			var count = 0;
			for(var i=0;i<ids.length;i++) {
				//如果多选框没有选中 , 让其选中
				if (ids[i].checked == true && i != 0) {
					ids[i].checked = true;
					var aa = $(ids[i]).parent().parent().find("#alias").val();
					if (ids[i].value != "") {
						if (count == 0) {
							str += '{"mac":"' + ids[i].value + '","ip":"' + $(ids[i]).attr("device_ip") + '","devType":3,"alias":"' + aa + '"}';
						}
						else {
							str += ',{"mac":"' + ids[i].value + '","ip":"' + $(ids[i]).attr("device_ip") + '","devType":3,"alias":"' + aa + '"}';
						}
						count++;
					}
				}

			}
			str = JSON.parse("["+str+"]");

			if(str != "")
			{
				//var deviceInfo = new EnableDevice(str);//类型为3 的是网关
				//alert(stringify(deviceInfo));
				$.ajax({
					type: "PUT",
					async: false,
					url: locationHref+"/rest/admin/devices/enableDevList",// 请求设备列表授权
					data:str,
					 success: function (data) {
						 window.location.reload();
					 },
					error:function(data)
					{
						var errorObj = data;
						var status = data.status;
						var statusText = data.statusText
						if(status == 401 || status == 400)
						{
							top.location.href = "login.html";
						}
					}
				 })
			}
			else
			{
				window.top.art.dialog({id:"mesg",content:PleaseFirstSelect+"!",time:2});
			}
		}
		var refresh_status;
		//自动刷新搜索到的编码器
		function auto_refresh()
		{
			refresh_status = setInterval(function(){
				$("#add_dom").empty();
				init_data();

			},3000)
			refresh_flag = false;
			$("#auto_refresh").hide();
			$("#close_refresh").show();
		}
		//停止自动刷新
		function close_refresh()
		{
			clearInterval(refresh_status);
			window.location.reload();
		}
		//重新搜索编码器
		function rescan()
		{
			$("#add_dom").empty()
			init_data();
		}
		//修改ip地址
		function modifyip(mac)
		{
			window.top.art.dialog
			(
					{
						id:'modifyip',iframe:'modifyip.html?mac='+mac, title:Modify_IP_Address, width:'350', height:'200', lock:true,window:'top'
					},
					function(){
						var d = window.top.art.dialog({id:'modifyip'}).data.iframe;
						d.modifyIp(mac);
						window.top.art.dialog({id:'modifyip'}).close()
						window.location.reload();
						return false;
					},
					function()
					{
						window.top.art.dialog({id:'modifyip'}).close()
					}
			);void(0);
		}
		//注册网关
		function registerEncoder(ip)
		{
			$.ajax({
				type: "PUT",
				async: false,
				url: locationHref+"/rest/admin/devices/"+ip+"/registerEncoder",// 将设备注册
				success: function (data)
				{
					if(data == "false")
					{
						window.top.art.dialog({id:"mesg",content:PleaseAddNetwork+"!",time:1});
					}
					else
					{
						window.location.reload();
					}
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}
	</script>
</head>
<body id="live_body_id" scroll="yes" style="overflow-y: scroll;">
	<div class="pad-10">
		<div class="col-tab">
			<ul class="tabBut cu-li">
				<li onclick="SwapTab('setting','on','',1,1);" class="on" id="tab_setting_1">网关列表</li>
				<!--<li onclick="SwapTab('setting','on','',2,2);" class="" id="tab_setting_2">网关设置</li>-->
			</ul>
			<div class="contentList pad-10" id="div_setting_1"><!-- 网关列表 -->
				<fieldset>
					<legend id="groupManager">分组管理</legend>
					<div style="margin-top: 10px;margin-left: 10px;margin-bottom: 10px;">
						<input type="button" id="addGroup" class="ext_btn ext_btn_submit ext_btn_size" value="添加" onclick="addApkGroup(1)"/><!-- 添加 -->
						<input type="button" id="editGroup" class="sp_a_but_padding btn-info" value="编辑" onclick="addApkGroup(2)"/><!-- 编辑 -->
						<input type="button" id="delGroup" class="ext_btn_red ext_btn_size" value="删除" onclick="addApkGroup(3)"/><!-- 删除 -->
					</div>
					<div id="group_body">

					</div>
				</fieldset>
				<fieldset>
					<legend id="deviceApk">网关设备</legend>
					<table width="100%" class="table_form">
						<thead>
						<th width="16">
							<input value="" id="check_box" name="mediainfoIds" onclick="selectall1('mediainfoIds');" type="checkbox">
						</th>
						<th id="alias" style="text-align: center;">别名</th>
						<th id="mac" style="text-align: center;">mac</th>
						<th id="ip" style="text-align: center;">ip</th>
						<th id="enable" style="text-align: center;">授权状态</th>
						<th id="bOnline" style="text-align: center;">在线状态</th>
						<th id="groupName" style="text-align: center;">分组名称</th>
						<th id="operation" style="text-align: center;">操作</th>
						</thead>
						<tbody id="main_body">

						</tbody>
					</table>
					<div class="btncms" style="position:relative">
						<label for="check_box" style="cursor:pointer;height:auto" class="sp_but_cir sp_but_padding btn btn-primary" id="all_operation">全选/取消</label>
						<a id="save" href="javascript:;" onclick="enableDevList()" class="ext_btn ext_btn_success">保存</a>
						<a id="groupDev" href="javascript:;" onclick="groupDevList()" class="ext_btn ext_btn_success">批量分组</a>
					</div>
				</fieldset>
				<fieldset>
					<legend id="allDevice">全部设备</legend>
					<div class="content-menu" >
						<a id="auto_refresh" href="javascript:;" onclick="auto_refresh()" class="ext_btn ext_btn_success">自动刷新</a>
						<a id="close_refresh" href="javascript:;" style="display: none;" onclick="close_refresh()" class="ext_btn ext_btn_success">停止刷新</a>
						<a id="auto_refresh_1" href="javascript:;" onclick="rescan()" class="ext_btn ext_btn_success">重新扫描</a>
					</div>
					<table width="100%" class="list_table">
						<thead>
						<tr id="trHeader" valign="bottom" height="16">
							<th align="center" id="th_1">序号</th>
							<th align="center" id="th_2">IP</th>
							<th align="center" id="th_3">MAC</th>
							<th align="center" id="th_4">子网掩码</th>
							<th align="center" id="th_5">网关</th>
							<th align="center" id="th_6">固件版本</th>
							<th align="center" id="th_8">已注册</th>
							<th align="center" id="th_7">操作</th>
						</tr>
						</thead>
						<tbody id="add_dom">

						</tbody>
					</table>
				</fieldset>
			</div>
		</div>
	</div>

	<script type="text/javascript">

		function SwapTab(name,cls_show,cls_hide,cnt,cur){
			for(i=1;i<=cnt;i++){
				if(i==cur){
					$('#div_'+name+'_'+i).show();
					$('#tab_'+name+'_'+i).attr('class',cls_show);
				}else{
					$('#div_'+name+'_'+i).hide();
					$('#tab_'+name+'_'+i).attr('class',cls_hide);
				}
			}
			if(cur == 1)
			{
				getGateway();
				init_data();
			}
			/*else if(cur == 2)
			{
				alert("未完成设置");
			}*/
		}
		function load_file_list(id) {
			if(id=='') return false;
			$.getJSON('?m=admin&amp;c=category&amp;a=public_tpl_file_list&amp;style='+id+'&amp;catid=&amp;type=1', function(data){$('#page_template').html(data.page_template);});
		}
	</script>
</body>
</html>


