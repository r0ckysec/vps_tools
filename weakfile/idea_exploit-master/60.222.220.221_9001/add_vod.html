<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title></title>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
	<meta http-equiv="X-UA-Compatible" content="IE=8">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">

	<link rel="stylesheet" href="css/common.css">
	<link rel="stylesheet" href="css/main.css">
	<link href="css/sp.css" rel="stylesheet" type="text/css" />
	<link href="css/reset.css" rel="stylesheet" type="text/css" />
	<link href="css/system.css" rel="stylesheet" type="text/css" />
	<link href="css/table_form.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="js/jquery-1.4.1.js"></script>
	<script type="text/javascript" src="js/cookie.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/jquery.i18n.properties-1.0.9.js"></script>
	<script type="text/javascript" src="js/add_edit_live.js"></script>
	<script type="text/javascript" src="js/bean.js"></script>
	<script type="text/javascript">
		var InformationIsNotCorrect ;
		var CanNotAddSame;
		$(function(){
			Init_license(authorization);
			var Languages = $.cookie('internationalization');

			if ( Languages == null || Languages == "" )
			{
				Languages = 'zh' ;
			}
			jQuery.i18n.properties({
				name : 'strings', //资源文件名称
				path : '/i18n/', //资源文件路径
				mode : 'map', //用Map的方式使用资源文件中的值
				language : Languages,
				encoding : 'UTF-8', // 必须写 否则中文乱码
				callback : function() {//加载成功后设置显示内容
					$('#information').html($.i18n.prop('EssentialInformation'));
					$('#td_1').html($.i18n.prop('ApplyName'));
					$('#td_2').html($.i18n.prop('Alias'));
					$('#td_3').html($.i18n.prop('DirectoryPath'));
					$('#td_4').html($.i18n.prop('PathHint')+"<span style='color: red'>E:/data</span>");
					$('#td_5').html($.i18n.prop('PathHintName')+"<span style='color: red'>data</span>");

					CanNotAddSame = $.i18n.prop('CanNotAddSame')
					InformationIsNotCorrect = $.i18n.prop('InformationIsNotCorrect');
				}
			});
		});

		function addVod() {
			var array = new Array();
			$.ajax({
				type: "GET",
				async: false,
				url: locationHref+"/rest/admin/vodPaths",//获取虚拟目录
				success: function(data)
				{
					var obj = data;
					if(obj != "" && obj.length >0)
					{
						for(var i=0;i<obj.length;i++)
						{
							var getAppName = obj[i].appName;
							var getDataPath = obj[i].dataPath;
							var getAlias = obj[i].alias;
							var vod_array = new VodInfo(getAppName,getAlias,getDataPath,false,false);
							array[i] = vod_array;
						}

						var appName_main = $("#appName").val();
						var dataPath_main = $("#dataPath").val();
						var alias_main = $("#alias").val();
						/*var ssoEnable_main = $("#ssoEnable").val();
						if(ssoEnable_main == "true")
						{
							ssoEnable_main = true;
						}
						else
						{
							ssoEnable_main = false;
						}

						var advEnable_main = $("#advEnable").val();
						if(advEnable_main == "true")
						{
							advEnable_main = true;
						}
						else
						{
							advEnable_main = false;
						}*/
						var flag_main = true;
						if(appName_main != "" && dataPath_main != "" && alias_main != "" && appName_main != null && dataPath_main != null && alias_main != null)
						{
							var vod_main  = null;
							for(var j=0;j<array.length;j++)
							{
								if(dataPath_main.toLowerCase() == array[j].dataPath.toLowerCase() || appName_main.toLowerCase() == array[j].appName.toLowerCase())
								{
									flag_main  = false;
								}
							}
							if(flag_main )
							{
								vod_main  = new VodInfo(appName_main,alias_main,dataPath_main,false,false);
								//alert(typeof vod);
								 $.ajax({
									 type: "POST",
									 url: locationHref+"/rest/admin/vodPaths",//添加虚拟目录
									 async: false,
									 data: stringify(vod_main ),
									 success:function(data)
									 {
										 $.ajax({
											 type: "POST",
											 url: locationHref+"/rest/admin/vodTypes/search/storage",//扫描媒体库
											 async: false,
											 success:function(data)
											 {

											 },
											 error:function(data)
											 {
												 var errorObj = data;
												 var status = data.status;
												 var statusText = data.statusText
												 if(status == 401 || status == 400)
												 {
													 top.location.href = "login.html";
												 }
											 }
										 });
									 },
									 error:function(data)
									 {
										 var errorObj = data;
										 var status = data.status;
										 var statusText = data.statusText
										 if(status == 401 || status == 400)
										 {
											 top.location.href = "login.html";
										 }
									 }
								 });
							}
							else
							{
								window.top.art.dialog({id:"mesg",content:CanNotAddSame+"!",time:2});
							}
						}
						else
						{
							window.top.art.dialog({id:"isNull",content:InformationIsNotCorrect+"...<img width=20 src='images/loading.gif'>",time:2});

						}
					}
					else
					{
						var appName = $("#appName").val();
						var dataPath = $("#dataPath").val();
						var alias = $("#alias").val();
						/*var ssoEnable = $("#ssoEnable").val();
						if(ssoEnable == "true")
						{
							ssoEnable = true;
						}
						else
						{
							ssoEnable = false;
						}

						var advEnable = $("#advEnable").val();
						if(advEnable == "true")
						{
							advEnable = true;
						}
						else
						{
							advEnable = false;
						}*/
						var flag = true;
						if(appName != "" && dataPath != "" && alias != "" && appName != null && dataPath != null && alias != null)
						{
							var vod = new VodInfo(appName,alias,dataPath,false,false);
							//alert(typeof vod);
							$.ajax({
								type: "POST",
								url: locationHref+"/rest/admin/vodPaths",//添加虚拟目录
								async: false,
								data: stringify(vod),
								success:function(data) {

								},
								error:function(data)
								{
									var errorObj = data;
									var status = data.status;
									var statusText = data.statusText
									if(status == 401 || status == 400)
									{
										top.location.href = "login.html";
									}
								}

							});
						}
					}
				}
			})
		}
	</script>
</head>

<body>

<div class="pad-10">
<div class="common-form">
<form id="myform" method="post" action="" name="myform">
	<input type="hidden" name="dialog" value="add">
<fieldset>
	<legend id="information">基本信息</legend>
	<table width="100%" class="table_form">
		<tbody>
		<tr>
			<td width="80" id="td_1">应用名称</td>
			<td>
				<input type="text" id="appName" class="input-text" name="appName" value="">
				<span id="td_5">请输入与硬盘路径名称相同的名称路径(点播使用)<span style="color: red">data</span></span>
			</td>
		</tr>
		<tr>
			<td width="80" id="td_2">别名</td> <td><input type="text" id="alias" class="input-text" name="alias" value=""></td>
		</tr>
		<tr>
			<td width="80" id="td_3">目录路径</td>
			<td>
				<input type="text" id="dataPath" class="input-text" name="dataPath" readonly value="">
				<input type="button" class="button" id="dataPathSelect" name="dataPathSelect" onclick="selectPath()" value="选择路径"/>
				<!--<span id="td_4">请输入硬盘存在的路径,路径格式<span style="color: red">E:/data</span></span>-->
			</td>
		</tr>
		<!--<tr>
			<td width="80" id="td_4">sso</td>
			<td>
				<select id="ssoEnable">
					<option value="false">false</option>
					<option value="true">true</option>
				</select>
			</td>
		</tr>
		<tr>
			<td width="80" id="td_5">广告标识</td>
			<td>
				<select id="advEnable">
					<option value="false">false</option>
					<option value="true">true</option>
				</select>
			</td>
		</tr>-->
		</tbody>
	</table>
    
</fieldset>
  
    <input type="submit" class="dialog" value="确定" id="dosubmit" name="dosubmit">
	<!--<a href="#" class=" sp_but_cir sp_but_padding btn btn-info" >取消</a>-->
	</form>
</div>
</div>

</body>
</html>
