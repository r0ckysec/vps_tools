<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=8">
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<link rel="stylesheet" href="css/common.css">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/main.css">
	<link href="css/sp.css" rel="stylesheet" type="text/css" />
	<link href="css/reset.css" rel="stylesheet" type="text/css" />
	<link href="css/system.css" rel="stylesheet" type="text/css" />
	<link href="css/table_form.css" rel="stylesheet" type="text/css" />
	<link href="css/dialog.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="js/dialog/jquery.ui.all.css"/>
	<script type="text/javascript" src="js/jquery-1.4.1.js"></script>
	<script type="text/javascript" src="js/jquery.corner.js"></script>
	<script type="text/javascript" src="js/admin_common.js"></script>
	<script type="text/javascript" src="js/dialog.js"></script>
	<script type="text/javascript" src="js/cookie.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/jquery.i18n.properties-1.0.9.js"></script>
	<script type="text/javascript" src="js/time.js"></script>
	<script type="text/javascript" src="js/ref_encode.js"></script>
	<script type="text/javascript" src="js/jquery.form.js"></script>
	<script type="text/javascript" src="js/encoder.js" ></script>
	<script type="text/javascript" src="js/add_edit_live.js"></script>
	<script type="text/javascript" src="js/bean.js"></script>

	<script type="text/javascript">
		var init_groupId = "";
		var AMS_Prompt ;
		var FailedToGetData ;
		var Grouping;
		var SubTitle;
		var Notgrouped;
		var PleaseFirstSelect;
		var DeleteMethod ;
		var AddCatalog;
		var EditCatalog;
		var DelCatalog;
		var Removethisuser;
		var Grouped;
		$(function(){
			Init_license(authorization);
			var Languages = $.cookie('internationalization');

			if ( Languages == null || Languages == "" )
			{
				Languages = 'zh' ;
			}
			jQuery.i18n.properties({
				name : 'strings', //资源文件名称
				path : '/i18n/', //资源文件路径
				mode : 'map', //用Map的方式使用资源文件中的值
				language : Languages,
				encoding : 'UTF-8', // 必须写 否则中文乱码
				callback : function() {//加载成功后设置显示内容
					$('#alias').html($.i18n.prop('Alias'));
					$('#enable').html($.i18n.prop('AuthEnable'));
					$('#bOnline').html($.i18n.prop('BOnline'));
					$('#groupId').html($.i18n.prop('GroupId'));
					$('#groupName').html($.i18n.prop('GroupName'));
					$('#operation').html($.i18n.prop('Operation'));
					$('#tab_setting_1').html($.i18n.prop('apkList'));
					$('#deviceApk').html($.i18n.prop('DeviceApk'));
					$('#save').html($.i18n.prop('Save'));
					$('#all_operation').html($.i18n.prop('Alloperation'));
					$('#addGroup').val($.i18n.prop('AddCatalog'));
					$('#editGroup').val($.i18n.prop('EditCatalog'));
					$('#delGroup').val($.i18n.prop('DelCatalog'));
					$('#addReplace').val($.i18n.prop('EmergencyBroadcast'));
					$('#addSubTitle').val($.i18n.prop('InsertSubtitle'));
					$('#addImage').val($.i18n.prop('InsertAPicture'));
					$('#groupManager').html($.i18n.prop('GroupManagement'));
					$('#groupDev').html($.i18n.prop('BatchGrouping'));
					SubTitle = $.i18n.prop('SubTitle') ;
					Grouping = $.i18n.prop('Grouping') ;
					AMS_Prompt = $.i18n.prop('AMS_Prompt') ;
					FailedToGetData = $.i18n.prop('FailedToGetData') ;
					Notgrouped = $.i18n.prop('Notgrouped') ;
					PleaseFirstSelect = $.i18n.prop('PleaseFirstSelect') ;
					DeleteMethod = $.i18n.prop('DeleteMethod') ;
					AddCatalog = $.i18n.prop('AddCatalog') ;
					EditCatalog = $.i18n.prop('EditCatalog') ;
					DelCatalog = $.i18n.prop('DelCatalog') ;
					Removethisuser = $.i18n.prop('Removethisuser') ;
					Grouped = $.i18n.prop('Grouped') ;
				}
			});
			init_whole_page();
		});

		(function($){
			$.getUrlParam = function(name)
			{
				var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
				var r = window.location.search.substr(1).match(reg);
				if (r!=null) return unescape(r[2]); return null;
			}
		})(jQuery);
		var liveType = $.getUrlParam("liveType");//区别权限是否显示

		//加载组信息
		function init_whole_page()
		{

			var hostHome = location.hostname;
			var apkUrl = "http://"+hostHome+":9001/apk/AokuLivePlayer.apk";
			$('#downLoadApk').attr('href',apkUrl);

			$("#group_body").empty();
			$.ajax({
				type: "GET",
				url: locationHref+"/rest/admin/termGroup", // 获取所有组
				success: function(data)
				{
					var obj = data;
					if(obj != "")
					{
						var checkBox_Name = 'deviceids';
						var dom = '<input id="checkAll" name="checkAll" type="checkbox" value="-1" onclick="selectallGroup(\''+checkBox_Name+'\');"><label for="checkAll" style="background-color: #7caccf ;" > 全部 </label>';
						for(var i=0;i<obj.length;i++)
						{
							var groupId = obj[i].groupId;
							var groupName = obj[i].groupName;
							var groupDevType = obj[i].devType;
							if(groupDevType == 1)
							{
								dom += '<input id="checkDevice_'+i+'" name="deviceids" type="checkbox" value="'+groupId+'" onclick="select_check_box(\''+groupId+'\')"><label for="checkDevice_'+i+'" style="background-color: #7caccf ;"> '+groupName+' </label>';
							}
						}
						$("#group_body").append(dom);

						agreementDevice(init_groupId);
					}
				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}

		//获取终端设备apk列表
		function agreementDevice(initGroupId)
		{
			var getGroupArray = new Array();
			var getGroupCount = 0;
			$('input[type=checkbox]:checked').each(function(i){
				var group_value = $(this).val()+"";
				getGroupArray[getGroupCount] = group_value;
				getGroupCount++;
			})

			var sendUrl;
			if(getGroupArray == "" || getGroupArray.indexOf("-1") != -1 || initGroupId == "-1")
			{
				initGroupId = "";
				sendUrl = locationHref+"/rest/admin/termGroup/1/"+initGroupId+"/getGroup"
			}
			else
			{
				initGroupId = stringify(getGroupArray);
				sendUrl = locationHref+"/rest/admin/termGroup/1/"+initGroupId+"/getGroups";
			}

			$("#main_body").empty();
			$.ajax({
				type: "GET",
				//url: locationHref+"/rest/admin/devices/1/get",//获取设备列表  1,机顶盒  //devType/groupId
				url: sendUrl,//获取组信息
				success: function (data)
				{
					var groupObj = data;
					if(groupObj != null)
					{
						if(getGroupArray == "" || getGroupArray.indexOf("-1") != -1 || initGroupId == "-1")
						{
							var groupId = groupObj.groupId;
							var groupName = groupObj.groupName;
							var item = groupObj.item;
							getItems(item,initGroupId,getGroupArray,groupName);
						}
						else
						{
							for(var kk=0;kk<groupObj.length;kk++)
							{
								var groupId = groupObj[kk].groupId;
								var groupName = groupObj[kk].groupName;
								var item = groupObj[kk].item;
								getItems(item,initGroupId,getGroupArray,groupName);
							}

						}
					}

				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}

		//处理页面显示
		function getItems(item,initGroupId,getGroupArray,groupName)
		{
			if(item != null)
			{
				for(var i=0;i<item.length;i++)
				{
					var mac = item[i].mac;
					var devip = item[i].ip;
					var enable = item[i].enable;
					var bOnline = item[i].bOnline;
					var enableStr = "";
					var bOnlineStr = "";
					if(enable)
					{
						enableStr = '<font id="font'+i+'" style="font-size:14px;font-weight: bold; color: green">√</font>';
					}
					else
					{
						enableStr = '<font id="font'+i+'" style="font-size:14px;font-weight: bold; color: red">×</font>';
					}

					if(bOnline)
					{
						bOnlineStr = '<font id="font1'+i+'" style="font-size:14px;font-weight: bold; color: green">√</font>';
					}
					else
					{
						bOnlineStr = '<font id="font1'+i+'" style="font-size:14px;font-weight: bold; color: red">×</font>';
					}
					var alias = item[i].alias;
					var subtitle = item[i].subtitle;
					if(alias == undefined)
					{
						alias = "";
					}
					if(subtitle == undefined)
					{
						subtitle = "";
					}
					var time = "";
					var word = "";
					if(subtitle != null)
					{
						time = subtitle.time;
						word = subtitle.word;
					}
					if(time == undefined)
					{
						time = "";
					}
					if(word == undefined)
					{
						word = "";
					}
					var get_groupId = item[i].groupId;
					var sendGroupName = item[i].groupName;
					if(sendGroupName == "" || sendGroupName == undefined)
					{
						sendGroupName = Notgrouped;
					}
					var get_groupName;
					if(get_groupId == "")
					{
						get_groupId = Notgrouped;
						get_groupName = Notgrouped;
					}
					else
					{
						if(getGroupArray == "" || getGroupArray.indexOf("-1") != -1 || initGroupId == "-1")
						{
							get_groupName = sendGroupName;
						}
						else
						{
							get_groupName = groupName;
						}
					}

					var del = '<a href="javascript:;" onclick="delConnection(\''+mac+'\',\''+get_groupId+'\')" title="'+Removethisuser+'" class="ext_btn_red ext_btn_size">'+Removethisuser+'</a>&nbsp';

					var dom = '<tr>';
					dom += '<td align="center">';
					dom += '<input type="checkbox" class="inputcheckbox"  name="mediainfoIds" device_ip="' + devip + '" alias_name="'+alias+'" bOnline="'+bOnline+'" enable="'+enable+'" value="' + mac + '" word="'+word+'" time="'+time+'">';
					dom += '</td>';
					dom += '<td align="center"><input type="text" class="input-text" id="alias" name="alias" value="'+alias+'"></td>';
					dom += '<td align="center">' + mac + '</td>';
					dom += '<td align="center">' + devip + '</td>';
					dom += '<td align="center">' + enableStr + '</td>';
					dom += '<td align="center">' + bOnlineStr + '</td>';
					dom += '<td align="center">' + get_groupName + '</td>';
					if(get_groupId == '0')
					{
						//dom += '<td align="center"> '+subTitle+ '</td>';
					}
					else
					{
						dom += '<td align="center">'+del+'</td>';//'+subTitle+ '
					}
					dom += '</tr>';
					$("#main_body").append(dom);
				}
			}
		}

		//---------------------------------------获取操作------------------------------------------
		//移除用户
		function delConnection(beforeMac,groupId)
		{
			$.ajax({
				type: "DELETE",
				url: locationHref + "/rest/admin/termGroup/" + groupId +"/"+beforeMac+ "/delDev",//删除组设备
				success: function (data)
				{
					window.location.reload();
				}
			})
		}
		//批量分组
		function groupDevList()
		{
			var ids = document.getElementsByName("mediainfoIds");
			var array = new Array();
			var str = "";
			//拼接以ID和@组合而成的字符串
			var count = 0;
			for(var i=0;i<ids.length;i++) {
				//如果多选框没有选中 , 让其选中
				if (ids[i].checked == true && i != 0) {
					ids[i].checked = true;
					var aa = $(ids[i]).parent().parent().find("#alias").val();
					if (ids[i].value != "") {
						if (count == 0) {
							str += '{"mac":"' + $(ids[i]).val() + '","alias":"' + aa + '"}';
						}
						else {
							str += ',{"mac":"' + $(ids[i]).val() + '","alias":"' + aa + '"}';
						}
						count++;
					}
				}
			}
			str = "["+str+"]";
			window.top.art.dialog
			(
				{
					id:'deviceGroup',iframe:'addDeviceToGroup.html?apkList='+encodeURI(encodeURI(str))+'&type=1', title:'批量分组', width:'500', height:'200', lock:true,window:'top'
				},
				function(){
					var d = window.top.art.dialog({id:'deviceGroup'}).data.iframe;
					d.addDeviceToGroup();
					window.top.art.dialog({id:'deviceGroup'}).close()
					window.location.href='/apkManager.html';
					return false;
				},
				function()
				{
					window.top.art.dialog({id:'deviceGroup'}).close()
				}
			);void(0);
		}


		function select_check_box(id)
		{
			var allcheckBoxs=document.getElementsByName("checkAll");
			var select=document.getElementsByName('deviceids');

			var flag = true;
			for(var i=0;i<select.length;i++)
			{
				if(!select[i].checked)
				{
					flag = false;
				}
			}
			if(flag)
			{
				//每一个都选择，全选按钮被选择
				for(var z=0;z<allcheckBoxs.length;z++)
				{
					allcheckBoxs[z].checked = true;
				}
			}
			else
			{
				//有一个不选择，全选按钮则不选择
				for(var y=0;y<allcheckBoxs.length;y++)
				{
					allcheckBoxs[y].checked = false;
				}
			}

			var length = $('input[type=checkbox]:checked').length;
			if (length == 0)
			{
				$("#editGroup").attr("disabled", true);
				$("#delGroup").attr("disabled", true);
				$("#addImage").attr("disabled", true);
				$("#addSubTitle").attr("disabled", true);
				$("#addReplace").attr("disabled", true);
			}
			else if(length > 1)//选中多个
			{
				$("#editGroup").attr("disabled", true);
				$("#delGroup").attr("disabled", true);
				$("#addImage").attr("disabled", false);
				$("#addSubTitle").attr("disabled", false);
				$("#addReplace").attr("disabled", false);
			}
			else//选中一个
			{
				$("#addImage").attr("disabled", false);
				$("#addSubTitle").attr("disabled", false);
				$("#addReplace").attr("disabled", false);
				var device_group_val = $('input[type=checkbox]:checked').val();//组id
				var device_group_text = $('input[type=checkbox]:checked').next().text();//组name
				if (device_group_val == "0") {
					$("#editGroup").attr("disabled", true);
					$("#delGroup").attr("disabled", true);
				}
				else {
					$("#editGroup").attr("disabled", false);
					$("#delGroup").attr("disabled", false);
				}
			}

			if(id == undefined)
			{
				id = -1;
			}
			agreementDevice(id);
		}

		//组操作  type类型:::1, 添加 2, 编辑 3, 删除 4, 紧急插播 5, 插入字幕 6, 插入图片
		function addApkGroup(type)
		{
			if(type == 1)
			{
				var liveUrl = 'add_group_manager.html?deviceType=1';
				if(liveType == "only")
				{
					liveUrl = 'add_group_manager.html?liveType='+liveType+'&deviceType=1';
				}
				window.top.art.dialog
				(
						{
							id:'add',iframe:liveUrl, title:AddCatalog, width:'600', height:'400', lock:true,window:'top'
						},
						function(){
							var d = window.top.art.dialog({id:'add'}).data.iframe;
							d.addGroup();
							window.top.art.dialog({id:'add'}).close();
							init_whole_page();
							return false;
						},
						function()
						{
							window.top.art.dialog({id:'add'}).close();
						}
				);void(0);
			}
			else
			{
				var group_array = new Array();
				var group_array_simple = new Array();
				var length = $('input[type=checkbox]:checked').length;
				if (length == 0)
				{
					$("#editGroup").attr("disabled", true);
					$("#delGroup").attr("disabled", true);
					$("#addImage").attr("disabled", true);
					$("#addSubTitle").attr("disabled", true);
					$("#addReplace").attr("disabled", true);
				}
				else if(length > 1)//选中多个
				{
					var group_count = 0;
					$("#editGroup").attr("disabled", true);
					$("#delGroup").attr("disabled", true);
					$("#addImage").attr("disabled", false);
					$("#addSubTitle").attr("disabled", false);
					$("#addReplace").attr("disabled", false);
					$('input[type=checkbox]:checked').each(function(i){
						var group_value = $(this).val();
						group_array[group_count] = group_value;

						group_count++;
					})
				}
				else//选中一个
				{
					$("#addImage").attr("disabled", false);
					$("#addSubTitle").attr("disabled", false);
					$("#addReplace").attr("disabled", false);
					var device_group_val = $('input[type=checkbox]:checked').val();//组id
					var device_group_text = $('input[type=checkbox]:checked').next().text();//组name
					if (device_group_val == "0")
					{
						$("#editGroup").attr("disabled", true);
						$("#delGroup").attr("disabled", true);
					}
					else
					{
						$("#editGroup").attr("disabled", false);
						$("#delGroup").attr("disabled", false);
						if(type == 2)//editDialog(id,name,type)
						{
							window.top.art.dialog
							(
									{
										id:'edit',iframe:'edit_group_manager.html?id='+device_group_val+"&name="+device_group_text+"&devType=1", title:EditCatalog, width:'600', height:'400', lock:true,window:'top'
									},
									function(){
										var d = window.top.art.dialog({id:'edit'}).data.iframe;
										d.editGroup();
										window.top.art.dialog({id:'edit'}).close();
										init_whole_page();
										return false;

									},
									function()
									{
										window.top.art.dialog({id:'edit'}).close();
									}
							);void(0);
						}
						else if(type == 3)
						{
							window.top.art.dialog
							(
									{
										id:'del',content:DeleteMethod, title:DelCatalog,lock:true
									},
									function(){
										delGroup(device_group_val);
										window.top.art.dialog({id:'del'}).close();
										init_whole_page();
										return true;
									},
									function()
									{
										window.top.art.dialog({id:'del'}).close();
									}
							)
						}
					}
					group_array_simple[0] = device_group_val;
				}

				var groupId_array;
				if (length == 1)
				{
					groupId_array = group_array_simple;
				}
				else
				{
					groupId_array = group_array;
				}
				//alert(stringify(groupId_array))

				if(type == 4)//插播
				{
					window.top.art.dialog
					(
						{
							id:'emergencyReplace',iframe:'emergencyReplace.html?id='+device_group_val+"&name="+device_group_text+"&devType=1&gourp="+groupId_array, title:'紧急插播', width:'600', height:'400', lock:true,window:'top'
						},
						function()
						{
						 	var d = window.top.art.dialog({id:'emergencyReplace'}).data.iframe;
						 	d.emergencyReplace();
						 	window.top.art.dialog({id:'emergencyReplace'}).close();
						 	window.location.reload();
						 	return false;
						},
						function()
						{
							window.top.art.dialog({id:'emergencyReplace'}).close();
						}
					);void(0);
				}
				else if(type == 5)//字幕
				{
					window.top.art.dialog
					(
						{
							id:'emergencySubTitle',iframe:'emergencySubTitle.html?id='+device_group_val+"&name="+device_group_text+"&devType=1&gourp="+groupId_array, title:'插入字幕', width:'600', height:'400', lock:true,window:'top'
						},
						function()
						{
							var d = window.top.art.dialog({id:'emergencySubTitle'}).data.iframe;
							d.emergencySubTitle();
							window.top.art.dialog({id:'emergencySubTitle'}).close();
							window.location.reload();
							return false;
						},
						function()
						{
							window.top.art.dialog({id:'emergencySubTitle'}).close();
						}
					);void(0);
				}
				else if(type == 6)//插入图片
				{
					window.top.art.dialog
					(
						{
							id:'emergencyImage',iframe:'emergencyImage.html?id='+device_group_val+"&name="+device_group_text+"&devType=1&gourp="+groupId_array, title:'插入图片', width:'600', height:'400', lock:true,window:'top'
						},
						function()
						{
							var d = window.top.art.dialog({id:'emergencyImage'}).data.iframe;
							d.emergencyImage();
							window.top.art.dialog({id:'emergencyImage'}).close();
							window.location.reload();
							return false;
						},
						function()
						{
							window.top.art.dialog({id:'emergencyImage'}).close();
						}
					);void(0);
				}
			}
		}
		//删除机顶盒组
		function delGroup(id)
		{
			$.ajax({
				type:"DELETE",
				url:locationHref+"/rest/admin/termGroup/"+id+"/delete", //删除组
				async: false,
				contentType: "application/json; charset=utf-8",
				success:function(data){

				},
				error:function(data)
				{
					var errorObj = data;
					var status = data.status;
					var statusText = data.statusText
					if(status == 401 || status == 400)
					{
						top.location.href = "login.html";
					}
				}
			})
		}
		//-----------------------------------------分组操作-----------------------------------------

		//全选
		function selectall1(name) {
			if ($("#check_box").attr("checked")==false) {
				$("input[name='"+name+"']").each(function() {
					this.checked=false;
				});
			} else {
				$("input[name='"+name+"']").each(function() {
					this.checked=true;
				});
			}
		}
		//全选组
		function selectallGroup(name) {
			if ($("#checkAll").attr("checked")==false) {
				$("input[name='"+name+"']").each(function() {
					this.checked=false;
				});
			} else {
				$("input[name='"+name+"']").each(function() {
					this.checked=true;
				});
			}

			var length = $('input[type=checkbox]:checked').length;
			if (length == 0)
			{
				$("#editGroup").attr("disabled", true);
				$("#delGroup").attr("disabled", true);
				$("#addImage").attr("disabled", true);
				$("#addSubTitle").attr("disabled", true);
				$("#addReplace").attr("disabled", true);
			}
			else if(length > 1)//选中多个
			{
				$("#editGroup").attr("disabled", true);
				$("#delGroup").attr("disabled", true);
				$("#addImage").attr("disabled", false);
				$("#addSubTitle").attr("disabled", false);
				$("#addReplace").attr("disabled", false);
			}
			else//选中一个
			{
				$("#addImage").attr("disabled", false);
				$("#addSubTitle").attr("disabled", false);
				$("#addReplace").attr("disabled", false);
				var device_group_val = $('input[type=checkbox]:checked').val();//组id
				var device_group_text = $('input[type=checkbox]:checked').next().text();//组name
				if (device_group_val == "0") {
					$("#editGroup").attr("disabled", true);
					$("#delGroup").attr("disabled", true);
				}
				else {
					$("#editGroup").attr("disabled", false);
					$("#delGroup").attr("disabled", false);
				}
			}

			agreementDevice(-1);
		}
		//设备授权
		function enableDevList()
		{
			var ids = document.getElementsByName("mediainfoIds");
			var array = new Array();
			var str = "";
			//拼接以ID和@组合而成的字符串
			var count = 0;
			for(var i=0;i<ids.length;i++) {
				//如果多选框没有选中 , 让其选中
				if (ids[i].checked == true && i != 0) {
					ids[i].checked = true;
					var aa = $(ids[i]).parent().parent().find("#alias").val();
					if (ids[i].value != "") {
						if (count == 0) {
							str += '{"mac":"' + ids[i].value + '","ip":"' + $(ids[i]).attr("device_ip") + '","devType":1,"alias":"' + aa + '","subtitle":{"time":"'+$(ids[i]).attr("time")+'","word":"'+$(ids[i]).attr("word")+'"}}';
						}
						else {
							str += ',{"mac":"' + ids[i].value + '","ip":"' + $(ids[i]).attr("device_ip") + '","devType":1,"alias":"' + aa + ',"subtitle":{"time":"'+$(ids[i]).attr("time")+'","word":"'+$(ids[i]).attr("word")+'"}}';
						}
						count++;
					}
				}
			}
			//str = JSON.parse("["+str+"]");
			str = "["+str+"]";
			if(str != "")
			{
				$.ajax({
					type: "PUT",
					async: false,
					url: locationHref+"/rest/admin/devices/enableDevList",// 请求设备列表授权
					data:str,
					 success: function (data) {
						 window.location.reload();
					 },
					error:function(data)
					{
						var errorObj = data;
						var status = data.status;
						var statusText = data.statusText
						if(status == 401 || status == 400)
						{
							top.location.href = "login.html";
						}
					}
				 })
			}
			else
			{
				window.top.art.dialog({id:"mesg",content:PleaseFirstSelect+"!",time:2});
			}
		}

	</script>
</head>
<body id="live_body_id" scroll="yes" style="overflow-y: scroll;">
	<div class="pad-10">
		<div class="col-tab">
			<ul class="tabBut cu-li">
				<li onclick="SwapTab('setting','on','',2,1);" class="on" id="tab_setting_1">机顶盒列表</li>
				<a id="downLoadApk" href=""  class="ext_btn ext_btn_success">机顶盒apk下载</a>
			</ul>
			<div class="contentList pad-10" id="div_setting_1"><!-- 机顶盒列表 -->
				<fieldset>
					<legend id="groupManager">分组管理</legend>
					<div style="margin-top: 10px;margin-left: 10px;margin-bottom: 10px;">
						<input type="button" id="addGroup" class="ext_btn ext_btn_submit ext_btn_size" value="添加" onclick="addApkGroup(1)"/><!-- 添加 -->
						<input type="button" id="editGroup" class="sp_a_but_padding btn-info" value="编辑" onclick="addApkGroup(2)"/><!-- 编辑 -->
						<input type="button" id="delGroup" class="ext_btn_red ext_btn_size" value="删除" onclick="addApkGroup(3)"/><!-- 删除 -->
						<input type="button" id="addReplace" class="ext_btn ext_btn_submit ext_btn_size" value="紧急插播" onclick="addApkGroup(4)"/><!-- 紧急插播 -->
						<input type="button" id="addSubTitle" class="ext_btn ext_btn_submit ext_btn_size" value="插入字幕" onclick="addApkGroup(5)"/><!-- 插入字幕 -->
						<!--<input type="button" id="addImage" class="ext_btn ext_btn_submit ext_btn_size" value="插入图片" onclick="addApkGroup(6)"/>--><!-- 插入图片 -->
					</div>
					<div id="group_body">

					</div>
				</fieldset>
				<fieldset>
					<legend id="deviceApk">终端设备</legend>
					<table width="100%" class="table_form">
						<thead>
							<th width="16">
								<input value="" id="check_box" name="mediainfoIds" onclick="selectall1('mediainfoIds');" type="checkbox">
							</th>
							<th id="alias" style="text-align: center;">别名</th>
							<th id="mac" style="text-align: center;">mac</th>
							<th id="ip" style="text-align: center;">ip</th>
							<th id="enable" style="text-align: center;">授权状态</th>
							<th id="bOnline" style="text-align: center;">在线状态</th>
							<th id="groupName" style="text-align: center;">分组名称</th>
							<th id="operation" style="text-align: center;">操作</th>
						</thead>
						<tbody id="main_body">

						</tbody>
					</table>
					<div class="btncms" style="position:relative">
						<label for="check_box" style="cursor:pointer;height:auto" class="sp_but_cir sp_but_padding btn btn-primary" id="all_operation">全选/取消</label>
						<a id="save" href="javascript:;" onclick="enableDevList()" class="ext_btn ext_btn_success">保存</a>
						<a id="groupDev" href="javascript:;" onclick="groupDevList()" class="ext_btn ext_btn_success">批量分组</a>
					</div>
				</fieldset>
			</div>
		</div>
	</div>

	<script type="text/javascript">

		function SwapTab(name,cls_show,cls_hide,cnt,cur){
			for(i=1;i<=cnt;i++){
				if(i==cur){
					$('#div_'+name+'_'+i).show();
					$('#tab_'+name+'_'+i).attr('class',cls_show);
				}else{
					$('#div_'+name+'_'+i).hide();
					$('#tab_'+name+'_'+i).attr('class',cls_hide);
				}
			}
			if(cur == 1)
			{
				agreementDevice();
			}
		}
		function load_file_list(id) {
			if(id=='') return false;
			$.getJSON('?m=admin&amp;c=category&amp;a=public_tpl_file_list&amp;style='+id+'&amp;catid=&amp;type=1', function(data){$('#page_template').html(data.page_template);});
		}
	</script>
</body>
</html>


