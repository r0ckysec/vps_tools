<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=8">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/style.css">
    <link href="css/table_form.css" rel="stylesheet" type="text/css" />
    <link href="css/dialog.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="js/jquery-1.4.1.js"></script>
    <script type="text/javascript" src="js/jquery.SuperSlide.js"></script>
    <script type="text/javascript" src="js/jquery.corner.js"></script>
    <script type="text/javascript" src="js/admin_common.js"></script>
    <script type="text/javascript" src="js/dialog.js"></script>
    <script type="text/javascript" src="js/live.js"></script>
    <script type="text/javascript" src="js/cookie.js"></script>
    <script type="text/javascript" src="js/jbase64.js"></script>
    <script type="text/javascript" src="js/jquery.cookie.js"></script>
    <script type="text/javascript" src="js/jquery.i18n.properties-1.0.9.js"></script>
    <script type="text/javascript" src="js/admin_auth.js"></script>
    <script type="text/javascript">
        var NavigationPosition ;
        var SettopBoxManagement;
        var EncoderManagement;
        var TerminalGroup;
        $(function(){
            Init_license(authorization);
            var Languages = $.cookie('internationalization');

            if ( Languages == null || Languages == "" )
            {
                Languages = 'zh' ;
            }
                jQuery.i18n.properties({
                    name : 'strings', //资源文件名称
                    path : '/i18n/', //资源文件路径
                    mode : 'map', //用Map的方式使用资源文件中的值
                    language : Languages,
                    encoding : 'UTF-8', // 必须写 否则中文乱码
                    callback : function() {//加载成功后设置显示内容
                        $('#banner').html("Aoku&nbsp;Media&nbsp;Server&nbsp;"+$.i18n.prop('Title'));
                        $('#zh').html($.i18n.prop('Chinese'));
                        $('#en').html($.i18n.prop('English'));
                        $('#out').html($.i18n.prop('Exit'));
                        $('#wangzhan').html($.i18n.prop('English'));
                        $('#SiteJump').html($.i18n.prop('SiteJump'));
                        $('#here_area').html($.i18n.prop('NavigationPosition')+" : "+$.i18n.prop('LiveList'));
                        $('#list_1').html($.i18n.prop('BroadcastManagement'));
                        $('#list_3').html($.i18n.prop('AMS_Administration'));
                        $('#list_1_1').html($.i18n.prop('LiveList'));
                        $('#list_1_2').html($.i18n.prop('LiveOnlineUsers'));
                        $('#list_1_3').html($.i18n.prop('RecordingVideoManagement'));
                        $('#list_3_1').html($.i18n.prop('AMS_ParameterSetting'));
                        $('#list_3_2').html($.i18n.prop('AMS_VersionInformation'));
                        $('#list_3_3').html($.i18n.prop('SearchEncoder'));
                        $('#list_3_4').html($.i18n.prop('LicenseINformation'));
                        $('#list_3_5').html($.i18n.prop('activePage'));
                        $('#list_3_6').html($.i18n.prop('apkSet'));
                        $('#list_4').html($.i18n.prop('VideoTranscodingManagement'));
                        $('#list_4_1').html($.i18n.prop('TranscodingScheme'));
                        $("#list_7").html($.i18n.prop('UPDATEManagement'));
                        $("#list_7_1").html($.i18n.prop('AMSUpdateManagement'));
                        TerminalGroup = $.i18n.prop('TerminalGroup');
                        SettopBoxManagement = $.i18n.prop('Set-topBoxManagement');
                        EncoderManagement= $.i18n.prop('EncoderManagement');
                        NavigationPosition = $.i18n.prop('NavigationPosition');

                        $(function(){
                            $.ajax({
                                type: "GET",
                                url: locationHref+"/rest/admin/system/getLicenseInfo",//获取授权
                                success: function(data)
                                {
                                    var obj = data;
                                    if(obj != '')
                                    {
                                        var edition = obj.edition;
                                        if(edition == 3)
                                        {
                                            $("#list_3_5").show();
                                            $("#activePage").show();
                                            $(".sideMenu").slide({
                                                titCell:"h3",
                                                targetCell:"ul",
                                                defaultIndex:3,
                                                effect:'slideDown',
                                                delayTime:'10' ,
                                                trigger:'click',
                                                triggerTime:'150',
                                                defaultPlay:true,
                                                returnDefault:false,
                                                easing:'easeInQuint',
                                                endFun:function(){
                                                    scrollWW();
                                                }
                                            });
                                            $(window).resize(function() {
                                                scrollWW();
                                            });

                                            $("#zhongduan").empty();
                                            var zhong_dom = '<li clickurl="apkManager.html" id="list_11" >'+SettopBoxManagement+'</li>';
                                            zhong_dom += '<li clickurl="encodeManager.html" id="list_12" >'+EncoderManagement+'</li>';
                                            zhong_dom += '<li clickurl="group_manager.html?liveType=only" id="list_8_0" >'+TerminalGroup+'</li>';
                                            $("#zhongduan").append(zhong_dom);

                                            $(".sideMenu ul li").each(function(){

                                                $(this).mouseover(function(){
                                                    $(this).css("cursor","pointer");
                                                })

                                                $(this).click(function(){
                                                    //reset
                                                    $("#here_area").text(NavigationPosition+"："+$(this).text());
                                                    //alert($(this).text());
                                                    $(".sideMenu ul li").removeClass("on");
                                                    $(this).addClass("on");
                                                    var url = $(this).attr("clickurl");
                                                    window.open(url,"right2");
                                                })

                                            })
                                        }
                                        else
                                        {
                                            $("#list_3_5").hide();
                                            $("#activePage").hide();
                                            $(".sideMenu").slide({
                                                titCell:"h3",
                                                targetCell:"ul",
                                                defaultIndex:0,
                                                effect:'slideDown',
                                                delayTime:'10' ,
                                                trigger:'click',
                                                triggerTime:'150',
                                                defaultPlay:true,
                                                returnDefault:false,
                                                easing:'easeInQuint',
                                                endFun:function(){
                                                    scrollWW();
                                                }
                                            });
                                            $(window).resize(function() {
                                                scrollWW();
                                            });

                                            $("#zhongduan").empty();
                                            var zhong_dom = '<li clickurl="apkManager.html" id="list_11" >'+SettopBoxManagement+'</li>';
                                            zhong_dom += '<li clickurl="encodeManager.html" id="list_12" >'+EncoderManagement+'</li>';
                                            zhong_dom += '<li clickurl="group_manager.html?liveType=only" id="list_8_0" >'+TerminalGroup+'</li>';
                                            $("#zhongduan").append(zhong_dom);

                                            $(".sideMenu ul li").each(function(){

                                                $(this).mouseover(function(){
                                                    $(this).css("cursor","pointer");
                                                })

                                                $(this).click(function(){
                                                    //reset
                                                    $("#here_area").text(NavigationPosition+"："+$(this).text());
                                                    //alert($(this).text());
                                                    $(".sideMenu ul li").removeClass("on");
                                                    $(this).addClass("on");
                                                    var url = $(this).attr("clickurl");
                                                    window.open(url,"right");
                                                })

                                            })
                                        }
                                    }
                                    else
                                    {
                                        $(".sideMenu").slide({
                                            titCell:"h3",
                                            targetCell:"ul",
                                            defaultIndex:0,
                                            effect:'slideDown',
                                            delayTime:'10' ,
                                            trigger:'click',
                                            triggerTime:'150',
                                            defaultPlay:true,
                                            returnDefault:false,
                                            easing:'easeInQuint',
                                            endFun:function(){
                                                scrollWW();
                                            }
                                        });
                                        $(window).resize(function() {
                                            scrollWW();
                                        });

                                        $(".sideMenu ul li").each(function(){

                                            $(this).mouseover(function(){
                                                $(this).css("cursor","pointer");
                                            })

                                            $(this).click(function(){
                                                //reset
                                                $("#here_area").text(NavigationPosition+"："+$(this).text());
                                                //alert($(this).text());
                                                $(".sideMenu ul li").removeClass("on");
                                                $(this).addClass("on");
                                                var url = $(this).attr("clickurl");
                                                window.open(url,"right");
                                            })

                                        })
                                    }
                                    adminAuth();
                                },
                                error:function(data)
                                {
                                    var errorObj = data;
                                    var status = data.status;
                                    var statusText = data.statusText;
                                    if(status == 401 || status == 400)
                                    {
                                        top.location.href = "login.html";
                                    }
                                }
                            })

                            $.ajax({
                                type: "GET",
                                url: locationHref+"/rest/admin/system/getUpdate",//获取升级信息
                                async: false,
                                success:function(data)
                                {
                                    if(data == "" || data == null)
                                    {
                                        $("#list_7").hide();
                                    }
                                    else
                                    {
                                        $("#list_7").show();
                                        var obj = data;
                                        var isUpdate = obj.isUpdate;//是否需要更新
                                        if(isUpdate == true)
                                        {
                                            $("#list_7").addClass("red-point");
                                            $("#list_7_1").addClass("red-point");
                                        }
                                        else
                                        {
                                            $("#list_7").removeClass("ren-point");
                                            $("#list_7_1").removeClass("ren-point");
                                        }

                                    }
                                },
                                error:function(data)
                                {
                                    var errorObj = data;
                                    var status = data.status;
                                    var statusText = data.statusText;
                                    if(status == 401 || status == 400)
                                    {
                                        top.location.href = "login.html";
                                    }
                                }

                            })
                        });
                    }
                });
        });

        function scrollWW(){
            if($(".side").height()<$(".sideMenu").height())
            {
               $(".scroll").show();
               var pos = $(".sideMenu ul:visible").position().top-38;
               $('.sideMenu').animate({top:-pos});
            }
            else
            {
               $(".scroll").hide();
               $('.sideMenu').animate({top:0});
               n=1;
            }
        }

        var n=1;
        function menuScroll(num){
              var Scroll = $('.sideMenu');
              var ScrollP = $('.sideMenu').position();
              /*alert(n);
              alert(ScrollP.top);*/
              if(num==1){
                 Scroll.animate({top:ScrollP.top-38});
                 n = n+1;
              }else{
                if (ScrollP.top > -38 && ScrollP.top != 0) { ScrollP.top = -38; }
                if (ScrollP.top<0) {
                  Scroll.animate({top:38+ScrollP.top});
                }else{
                  n=1;
                }
                if(n>1){
                  n = n-1;
                }
              }
        }

         function  internationalization_cookie(language)
         {
             $.cookie("internationalization",language);
             window.location.reload();
         }


        function loginOutAdmin()
        {
            if(login_type == 1)
            {
                $.ajax({
                    type: "PUT",
                    url: locationHref + "/rest/admin/SupperAdminUsers/logout",//超级管理员退出登录
                    success:function()
                    {
                        delcookie("Authorization");
                        delcookie("AMS_SESSION_ID");
                        delcookie("LOGINTYPE");
                        delcookie("ADMINNAME");
                        window.location.href='login.html';
                    },
                    error:function(data)
                    {
                        var errorObj = data;
                        var status = data.status;
                        var statusText = data.statusText
                        if(status == 401 || status == 400)
                        {
                            top.location.href = "login.html";
                        }
                        else if(status == 409)
                        {
                            window.top.art.dialog({id:"mesg",content:statusText+"!",time:2});
                        }
                    }
                })
            }
            else
            {
                $.ajax({
                    type:"PUT",
                    url:locationHref+"/rest/admin/AdminUsers/logout",//管理员退出登录
                    success:function(data)
                    {
                        delcookie("Authorization");
                        delcookie("AMS_SESSION_ID");
                        delcookie("LOGINTYPE");
                        delcookie("ADMINNAME");
                        window.location.href='login.html';
                    },
                    error:function(data)
                    {
                        var errorObj = data;
                        var status = data.status;
                        var statusText = data.statusText
                        if(status == 401 || status == 400)
                        {
                            top.location.href = "login.html";
                        }
                        else if(status == 409)
                        {
                            window.top.art.dialog({id:"mesg",content:statusText+"!",time:2});
                        }
                    }
                })
            }
        }
    </script>
    <title>后台首页</title>
</head>
<body>
    <div class="top">
      <div id="top_t">
        <div class="fl"><div id="logo"></div><div id="banner">后台管理</div></div>
        <div id="photo_info" class="fr">
            <div style="margin-left: 100px">
                <a href="javascript:;" onclick="internationalization_cookie('zh')" id="zh" style="color: #F4F4F4">中文版</a>&nbsp; | &nbsp;
                <a href="javascript:;" onclick="internationalization_cookie('en')" id="en" style="color: #F4F4F4">英文版</a>
            </div>
          <div id="photo" class="fl">
            <a href="#"><img src="images/a.png" alt="" width="60" height="60"></a>
          </div>
          <div id="base_info" class="fr">
            <div class="help_info">
                <a style="color:#fff;float:right;padding-right:10px;" id="out" href="javascript:void(0);" onclick="loginOutAdmin()">退出</a>
			  <a target="_blank" style="color:#fff;float:right;padding-right:10px;width:90px;" href="pc_index.html" id="SiteJump">网站前台跳转</a>
            </div>
            <div class="info_center">
              admin
            </div>
          </div>
        </div>
      </div>
      <div id="side_here">
        <div id="side_here_l" class="fl"></div>
        <div id="here_area" class="fl" >当前位置：直播列表</div>
      </div>
    </div>
    <div class="side">
        <div class="sideMenu" style="margin:0 auto">
        <h3 id="list_1">频道管理</h3>
        <ul>
            <li clickurl="live_list.html" class="on" id="list_1_1">直播列表</li>
            <li clickurl="live_record_tree.html" id="list_1_3">录制视频管理</li>
            <li clickurl="live_conn_list.html" id="list_1_2">直播在线用户</li>
        </ul>
        <h3 id="list_8">终端管理</h3>
        <ul id="zhongduan">


        </ul>
        <h3 id="list_3">AMS管理</h3>
        <ul>
           <li clickurl="server_startup.html" id="list_3_1" >AMS参数设置</li>
           <li clickurl="lic_info.html" id="list_3_2" >AMS版本信息</li>
           <li clickurl="license_set.html" id="list_3_4" >AMS授权信息</li>
           <li clickurl="active_page.html" style="display: none;" class="on"  id="list_3_5" >AMS激活页面</li>
            <li clickurl="apk_setting.html" id="list_3_6" >机顶盒设置</li>
        </ul>
        <h3 id="list_4">视频转码管理</h3>
        <ul>
            <li clickurl="transfer_list.html" id="list_4_1" >转码方案</li>
        </ul>
        <h3 id="list_6">日志管理</h3>
        <ul>
            <li clickurl="log_list.html" id="list_6_1" >日志管理</li>
        </ul>
        <h3 id="list_7">升级管理</h3>
        <ul>
            <li clickurl="upload_sys.html" id="list_7_1" >AMS升级管理</li>
        </ul>
        </div>
    </div>
    <div class="main">
       <iframe name="right" id="rightMain" src="live_list.html" frameborder="no" scrolling="yes" width="100%" height="100%" allowtransparency="true"></iframe>
    </div>
    <div class="scroll">
          <a href="javascript:;" class="per" title="使用鼠标滚轴滚动侧栏" onclick="menuScroll(1);"></a>
          <a href="javascript:;" class="next" title="使用鼠标滚轴滚动侧栏" onclick="menuScroll(2);"></a>
    </div>
</body>

</html>
   
       